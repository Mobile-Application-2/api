var sv=Object.defineProperty;var ov=(u,n,i)=>n in u?sv(u,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):u[n]=i;var A=(u,n,i)=>ov(u,typeof n!="symbol"?n+"":n,i);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))o(f);new MutationObserver(f=>{for(const _ of f)if(_.type==="childList")for(const b of _.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&o(b)}).observe(document,{childList:!0,subtree:!0});function i(f){const _={};return f.integrity&&(_.integrity=f.integrity),f.referrerPolicy&&(_.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?_.credentials="include":f.crossOrigin==="anonymous"?_.credentials="omit":_.credentials="same-origin",_}function o(f){if(f.ep)return;f.ep=!0;const _=i(f);fetch(f.href,_)}})();class D{constructor(n,i){A(this,"_x");A(this,"_y");this._x=n,this._y=i}get x(){return this._x}get y(){return this._y}static get zero(){return new D(0,0)}get length(){return Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))}static copy(n){return new D(n.x,n.y)}addX(n){return new D(this._x,this._y).addToX(n)}addY(n){return new D(this._x,this._y).addToY(n)}addToX(n){return this._x+=n,this}addToY(n){return this._y+=n,this}addTo(n){return this.addToX(n.x).addToY(n.y)}add(n){return new D(this._x,this._y).addTo(n)}subtractTo(n){return this._x-=n.x,this._y-=n.y,this}subtract(n){return new D(this._x,this._y).subtractTo(n)}mult(n){return new D(this._x,this._y).multBy(n)}multBy(n){return this._x*=n,this._y*=n,this}dot(n){return this._x*n.x+this._y*n.y}distFrom(n){return this.subtract(n).length}}var wt=(u=>(u[u.CONTINUE=0]="CONTINUE",u[u.PVP=1]="PVP",u[u.PVC=2]="PVC",u[u.ToggleSound=3]="ToggleSound",u[u.GoToSubMenu=4]="GoToSubMenu",u[u.GoToPreviousMenu=5]="GoToPreviousMenu",u))(wt||{});const E={gameSize:{x:1500,y:825},soundOn:!0,timeoutToHideStickAfterShot:500,loadingScreenTimeout:5e3,loadingScreenImagePosition:{x:450,y:112.5},timeoutToLoadSubMenu:100,labels:{currentPlayer:{position:{x:640,y:260},color:"#126736",font:"70px Impact",alignment:"top",text:"PLAYER "},overalScores:[{position:{x:628,y:460},color:"#126736",font:"200px Impact",alignment:"top"},{position:{x:778,y:460},color:"#126736",font:"200px Impact",alignment:"top"}]},cueBallPosition:{x:413,y:413},matchScore:{scoresPositions:[{x:420,y:27},{x:932,y:27}],unitMargin:20},sprites:{basePath:"/game/Snooker/assets/sprites/",paths:{menuBackground:"main_menu_background.png",table:"spr_background4.png",cueBall:"spr_ball2.png",redBall:"spr_redBall2.png",yellowBall:"spr_yellowBall2.png",blackBall:"spr_blackBall2.png",stick:"spr_stick.png",twoPlayersButton:"2_players_button.png",twoPlayersButtonHovered:"2_players_button_hover.png",onePlayerButton:"1_player_button.png",onePlayerButtonHovered:"1_player_button_hover.png",muteButton:"mute_button.png",muteButtonHovered:"mute_button_hover.png",muteButtonPressed:"mute_button_pressed.png",muteButtonPressedHovered:"mute_button_pressed_hover.png",easyButton:"easy_button.png",easyButtonHovered:"easy_button_hover.png",mediumButton:"medium_button.png",mediumButtonHovered:"medium_button_hover.png",hardButton:"hard_button.png",hardButtonHovered:"hard_button_hover.png",backButton:"back_button.png",backButtonHovered:"back_button_hover.png",continueButton:"continue_button.png",continueButtonHovered:"continue_button_hover.png",insaneButton:"insane_button.png",insaneButtonHovered:"insane_button_hover.png",controls:"controls.png",redScore:"red_score.png",yellowScore:"yellow_score.png"}},sounds:{basePath:"/game/Snooker/assets/sounds/",paths:{ballsCollide:"BallsCollide.wav",strike:"Strike.wav",rail:"Hole.wav"}},physics:{friction:.018,collisionLoss:.018},table:{cushionWidth:57,pocketRadius:48,pocketsPositions:[{x:62,y:62},{x:750,y:32},{x:1435,y:62},{x:62,y:762},{x:750,y:794},{x:1435,y:762}]},ball:{diameter:38,origin:{x:25,y:25},minVelocityLength:.05,maxExpectedCollisionForce:70},stick:{origin:{x:970,y:11},shotOrigin:{x:950,y:11},powerToAddPerFrame:1,movementPerFrame:3,maxPower:50},input:{mouseSelectButton:0,mouseShootButton:0,mousePlaceBallButton:0,increaseShotPowerKey:87,decreaseShotPowerKey:83,toggleMenuKey:27},mainMenu:{labels:[{text:"Classic 8-Ball",position:{x:200,y:100},font:"100px Bookman",color:"white",alignment:"left"},{text:`© ${new Date().getFullYear()} Chen Shmilovich`,position:{x:1250,y:800},font:"20px Bookman",color:"white",alignment:"left"}],buttons:[{action:wt.PVP,position:{x:200,y:200},sprite:"twoPlayersButton",spriteOnHover:"twoPlayersButtonHovered"},{action:wt.GoToSubMenu,value:0,position:{x:200,y:400},sprite:"onePlayerButton",spriteOnHover:"onePlayerButtonHovered"},{action:wt.ToggleSound,position:{x:1430,y:10},sprite:"muteButton",spriteOnHover:"muteButtonHovered"}],subMenus:[{labels:[{text:"Choose Difficulty",position:{x:200,y:80},font:"70px Bookman",color:"white",alignment:"left"},{text:`© ${new Date().getFullYear()} Chen Shmilovich`,position:{x:1250,y:800},font:"20px Bookman",color:"white",alignment:"left"}],buttons:[{action:wt.GoToPreviousMenu,position:{x:100,y:150},sprite:"backButton",spriteOnHover:"backButtonHovered"},{action:wt.PVC,position:{x:200,y:150},value:30,sprite:"easyButton",spriteOnHover:"easyButtonHovered"},{action:wt.PVC,position:{x:200,y:300},value:50,sprite:"mediumButton",spriteOnHover:"mediumButtonHovered"},{action:wt.PVC,position:{x:200,y:450},value:100,sprite:"hardButton",spriteOnHover:"hardButtonHovered"},{action:wt.PVC,position:{x:200,y:600},value:700,sprite:"insaneButton",spriteOnHover:"insaneButtonHovered"},{action:wt.ToggleSound,position:{x:1430,y:10},sprite:"muteButton",spriteOnHover:"muteButtonHovered"}],subMenus:[]}]},cursor:{default:"default",button:"pointer"},ai:{on:!0,trainIterations:30,playerIndex:1,ballDistanceBonus:1/5800,validTurnBonus:5e3,pocketedBallBonus:2e3,invalidTurnPenalty:3e3,gameWonBonus:5e4,gameLossPenalty:5e4,shotPowerMutationVariance:15,minShotPower:10}};class ys{constructor(n=50,i=0,o=0){this.power=n,this.rotation=i,this.evaluation=o}}class uv{constructor(){}evaluate(n){let i=1;for(let o=0;o<n.balls.length;o++)for(let f=o+1;f<n.balls.length;f++){let _=n.balls[o],b=n.balls[f];i+=_.position.distFrom(b.position)*E.ai.ballDistanceBonus}return n.isTurnValid?(i+=E.ai.validTurnBonus,i+=E.ai.pocketedBallBonus*n.numOfPocketedBallsOnTurn,n.isGameOver&&(i+=E.ai.gameWonBonus)):(i=i-E.ai.invalidTurnPenalty,n.isGameOver&&(i-=E.ai.gameLossPenalty)),i}}var Dr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function av(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}var Fn={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var lv=Fn.exports,Sa;function cv(){return Sa||(Sa=1,function(u,n){(function(){var i,o="4.17.21",f=200,_="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",b="Expected a function",P="Invalid `variable` option passed into `_.template`",L="__lodash_hash_undefined__",ht=500,tt="__lodash_placeholder__",F=1,Zt=2,we=4,xe=1,$e=2,qt=1,Ke=2,qs=4,se=8,fn=16,oe=32,dn=64,ue=128,pn=256,Zr=512,ll=30,cl="...",hl=800,fl=16,$s=1,dl=2,pl=3,qn=1/0,Ye=9007199254740991,gl=17976931348623157e292,$n=NaN,Qt=4294967295,_l=Qt-1,vl=Qt>>>1,ml=[["ary",ue],["bind",qt],["bindKey",Ke],["curry",se],["curryRight",fn],["flip",Zr],["partial",oe],["partialRight",dn],["rearg",pn]],Xe="[object Arguments]",Kn="[object Array]",yl="[object AsyncFunction]",gn="[object Boolean]",_n="[object Date]",wl="[object DOMException]",Yn="[object Error]",Xn="[object Function]",Ks="[object GeneratorFunction]",$t="[object Map]",vn="[object Number]",xl="[object Null]",ae="[object Object]",Ys="[object Promise]",bl="[object Proxy]",mn="[object RegExp]",Kt="[object Set]",yn="[object String]",zn="[object Symbol]",Sl="[object Undefined]",wn="[object WeakMap]",Bl="[object WeakSet]",xn="[object ArrayBuffer]",ze="[object DataView]",Qr="[object Float32Array]",jr="[object Float64Array]",ti="[object Int8Array]",ei="[object Int16Array]",ni="[object Int32Array]",ri="[object Uint8Array]",ii="[object Uint8ClampedArray]",si="[object Uint16Array]",oi="[object Uint32Array]",Tl=/\b__p \+= '';/g,Al=/\b(__p \+=) '' \+/g,Cl=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Xs=/&(?:amp|lt|gt|quot|#39);/g,zs=/[&<>"']/g,El=RegExp(Xs.source),Pl=RegExp(zs.source),Ol=/<%-([\s\S]+?)%>/g,Rl=/<%([\s\S]+?)%>/g,Vs=/<%=([\s\S]+?)%>/g,Il=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ll=/^\w*$/,kl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ui=/[\\^$.*+?()[\]{}|]/g,Ml=RegExp(ui.source),ai=/^\s+/,Nl=/\s/,Dl=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Wl=/\{\n\/\* \[wrapped with (.+)\] \*/,Fl=/,? & /,Ul=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Hl=/[()=,{}\[\]\/\s]/,Gl=/\\(\\)?/g,ql=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Js=/\w*$/,$l=/^[-+]0x[0-9a-f]+$/i,Kl=/^0b[01]+$/i,Yl=/^\[object .+?Constructor\]$/,Xl=/^0o[0-7]+$/i,zl=/^(?:0|[1-9]\d*)$/,Vl=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vn=/($^)/,Jl=/['\n\r\u2028\u2029\\]/g,Jn="\\ud800-\\udfff",Zl="\\u0300-\\u036f",Ql="\\ufe20-\\ufe2f",jl="\\u20d0-\\u20ff",Zs=Zl+Ql+jl,Qs="\\u2700-\\u27bf",js="a-z\\xdf-\\xf6\\xf8-\\xff",tc="\\xac\\xb1\\xd7\\xf7",ec="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",nc="\\u2000-\\u206f",rc=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",to="A-Z\\xc0-\\xd6\\xd8-\\xde",eo="\\ufe0e\\ufe0f",no=tc+ec+nc+rc,li="['’]",ic="["+Jn+"]",ro="["+no+"]",Zn="["+Zs+"]",io="\\d+",sc="["+Qs+"]",so="["+js+"]",oo="[^"+Jn+no+io+Qs+js+to+"]",ci="\\ud83c[\\udffb-\\udfff]",oc="(?:"+Zn+"|"+ci+")",uo="[^"+Jn+"]",hi="(?:\\ud83c[\\udde6-\\uddff]){2}",fi="[\\ud800-\\udbff][\\udc00-\\udfff]",Ve="["+to+"]",ao="\\u200d",lo="(?:"+so+"|"+oo+")",uc="(?:"+Ve+"|"+oo+")",co="(?:"+li+"(?:d|ll|m|re|s|t|ve))?",ho="(?:"+li+"(?:D|LL|M|RE|S|T|VE))?",fo=oc+"?",po="["+eo+"]?",ac="(?:"+ao+"(?:"+[uo,hi,fi].join("|")+")"+po+fo+")*",lc="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",cc="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",go=po+fo+ac,hc="(?:"+[sc,hi,fi].join("|")+")"+go,fc="(?:"+[uo+Zn+"?",Zn,hi,fi,ic].join("|")+")",dc=RegExp(li,"g"),pc=RegExp(Zn,"g"),di=RegExp(ci+"(?="+ci+")|"+fc+go,"g"),gc=RegExp([Ve+"?"+so+"+"+co+"(?="+[ro,Ve,"$"].join("|")+")",uc+"+"+ho+"(?="+[ro,Ve+lo,"$"].join("|")+")",Ve+"?"+lo+"+"+co,Ve+"+"+ho,cc,lc,io,hc].join("|"),"g"),_c=RegExp("["+ao+Jn+Zs+eo+"]"),vc=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,mc=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],yc=-1,Q={};Q[Qr]=Q[jr]=Q[ti]=Q[ei]=Q[ni]=Q[ri]=Q[ii]=Q[si]=Q[oi]=!0,Q[Xe]=Q[Kn]=Q[xn]=Q[gn]=Q[ze]=Q[_n]=Q[Yn]=Q[Xn]=Q[$t]=Q[vn]=Q[ae]=Q[mn]=Q[Kt]=Q[yn]=Q[wn]=!1;var Z={};Z[Xe]=Z[Kn]=Z[xn]=Z[ze]=Z[gn]=Z[_n]=Z[Qr]=Z[jr]=Z[ti]=Z[ei]=Z[ni]=Z[$t]=Z[vn]=Z[ae]=Z[mn]=Z[Kt]=Z[yn]=Z[zn]=Z[ri]=Z[ii]=Z[si]=Z[oi]=!0,Z[Yn]=Z[Xn]=Z[wn]=!1;var wc={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},xc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},bc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Sc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Bc=parseFloat,Tc=parseInt,_o=typeof Dr=="object"&&Dr&&Dr.Object===Object&&Dr,Ac=typeof self=="object"&&self&&self.Object===Object&&self,ft=_o||Ac||Function("return this")(),pi=n&&!n.nodeType&&n,Me=pi&&!0&&u&&!u.nodeType&&u,vo=Me&&Me.exports===pi,gi=vo&&_o.process,Lt=function(){try{var p=Me&&Me.require&&Me.require("util").types;return p||gi&&gi.binding&&gi.binding("util")}catch{}}(),mo=Lt&&Lt.isArrayBuffer,yo=Lt&&Lt.isDate,wo=Lt&&Lt.isMap,xo=Lt&&Lt.isRegExp,bo=Lt&&Lt.isSet,So=Lt&&Lt.isTypedArray;function Ct(p,m,v){switch(v.length){case 0:return p.call(m);case 1:return p.call(m,v[0]);case 2:return p.call(m,v[0],v[1]);case 3:return p.call(m,v[0],v[1],v[2])}return p.apply(m,v)}function Cc(p,m,v,T){for(var k=-1,K=p==null?0:p.length;++k<K;){var ot=p[k];m(T,ot,v(ot),p)}return T}function kt(p,m){for(var v=-1,T=p==null?0:p.length;++v<T&&m(p[v],v,p)!==!1;);return p}function Ec(p,m){for(var v=p==null?0:p.length;v--&&m(p[v],v,p)!==!1;);return p}function Bo(p,m){for(var v=-1,T=p==null?0:p.length;++v<T;)if(!m(p[v],v,p))return!1;return!0}function be(p,m){for(var v=-1,T=p==null?0:p.length,k=0,K=[];++v<T;){var ot=p[v];m(ot,v,p)&&(K[k++]=ot)}return K}function Qn(p,m){var v=p==null?0:p.length;return!!v&&Je(p,m,0)>-1}function _i(p,m,v){for(var T=-1,k=p==null?0:p.length;++T<k;)if(v(m,p[T]))return!0;return!1}function j(p,m){for(var v=-1,T=p==null?0:p.length,k=Array(T);++v<T;)k[v]=m(p[v],v,p);return k}function Se(p,m){for(var v=-1,T=m.length,k=p.length;++v<T;)p[k+v]=m[v];return p}function vi(p,m,v,T){var k=-1,K=p==null?0:p.length;for(T&&K&&(v=p[++k]);++k<K;)v=m(v,p[k],k,p);return v}function Pc(p,m,v,T){var k=p==null?0:p.length;for(T&&k&&(v=p[--k]);k--;)v=m(v,p[k],k,p);return v}function mi(p,m){for(var v=-1,T=p==null?0:p.length;++v<T;)if(m(p[v],v,p))return!0;return!1}var Oc=yi("length");function Rc(p){return p.split("")}function Ic(p){return p.match(Ul)||[]}function To(p,m,v){var T;return v(p,function(k,K,ot){if(m(k,K,ot))return T=K,!1}),T}function jn(p,m,v,T){for(var k=p.length,K=v+(T?1:-1);T?K--:++K<k;)if(m(p[K],K,p))return K;return-1}function Je(p,m,v){return m===m?$c(p,m,v):jn(p,Ao,v)}function Lc(p,m,v,T){for(var k=v-1,K=p.length;++k<K;)if(T(p[k],m))return k;return-1}function Ao(p){return p!==p}function Co(p,m){var v=p==null?0:p.length;return v?xi(p,m)/v:$n}function yi(p){return function(m){return m==null?i:m[p]}}function wi(p){return function(m){return p==null?i:p[m]}}function Eo(p,m,v,T,k){return k(p,function(K,ot,J){v=T?(T=!1,K):m(v,K,ot,J)}),v}function kc(p,m){var v=p.length;for(p.sort(m);v--;)p[v]=p[v].value;return p}function xi(p,m){for(var v,T=-1,k=p.length;++T<k;){var K=m(p[T]);K!==i&&(v=v===i?K:v+K)}return v}function bi(p,m){for(var v=-1,T=Array(p);++v<p;)T[v]=m(v);return T}function Mc(p,m){return j(m,function(v){return[v,p[v]]})}function Po(p){return p&&p.slice(0,Lo(p)+1).replace(ai,"")}function Et(p){return function(m){return p(m)}}function Si(p,m){return j(m,function(v){return p[v]})}function bn(p,m){return p.has(m)}function Oo(p,m){for(var v=-1,T=p.length;++v<T&&Je(m,p[v],0)>-1;);return v}function Ro(p,m){for(var v=p.length;v--&&Je(m,p[v],0)>-1;);return v}function Nc(p,m){for(var v=p.length,T=0;v--;)p[v]===m&&++T;return T}var Dc=wi(wc),Wc=wi(xc);function Fc(p){return"\\"+Sc[p]}function Uc(p,m){return p==null?i:p[m]}function Ze(p){return _c.test(p)}function Hc(p){return vc.test(p)}function Gc(p){for(var m,v=[];!(m=p.next()).done;)v.push(m.value);return v}function Bi(p){var m=-1,v=Array(p.size);return p.forEach(function(T,k){v[++m]=[k,T]}),v}function Io(p,m){return function(v){return p(m(v))}}function Be(p,m){for(var v=-1,T=p.length,k=0,K=[];++v<T;){var ot=p[v];(ot===m||ot===tt)&&(p[v]=tt,K[k++]=v)}return K}function tr(p){var m=-1,v=Array(p.size);return p.forEach(function(T){v[++m]=T}),v}function qc(p){var m=-1,v=Array(p.size);return p.forEach(function(T){v[++m]=[T,T]}),v}function $c(p,m,v){for(var T=v-1,k=p.length;++T<k;)if(p[T]===m)return T;return-1}function Kc(p,m,v){for(var T=v+1;T--;)if(p[T]===m)return T;return T}function Qe(p){return Ze(p)?Xc(p):Oc(p)}function Yt(p){return Ze(p)?zc(p):Rc(p)}function Lo(p){for(var m=p.length;m--&&Nl.test(p.charAt(m)););return m}var Yc=wi(bc);function Xc(p){for(var m=di.lastIndex=0;di.test(p);)++m;return m}function zc(p){return p.match(di)||[]}function Vc(p){return p.match(gc)||[]}var Jc=function p(m){m=m==null?ft:je.defaults(ft.Object(),m,je.pick(ft,mc));var v=m.Array,T=m.Date,k=m.Error,K=m.Function,ot=m.Math,J=m.Object,Ti=m.RegExp,Zc=m.String,Mt=m.TypeError,er=v.prototype,Qc=K.prototype,tn=J.prototype,nr=m["__core-js_shared__"],rr=Qc.toString,X=tn.hasOwnProperty,jc=0,ko=function(){var t=/[^.]+$/.exec(nr&&nr.keys&&nr.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),ir=tn.toString,th=rr.call(J),eh=ft._,nh=Ti("^"+rr.call(X).replace(ui,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),sr=vo?m.Buffer:i,Te=m.Symbol,or=m.Uint8Array,Mo=sr?sr.allocUnsafe:i,ur=Io(J.getPrototypeOf,J),No=J.create,Do=tn.propertyIsEnumerable,ar=er.splice,Wo=Te?Te.isConcatSpreadable:i,Sn=Te?Te.iterator:i,Ne=Te?Te.toStringTag:i,lr=function(){try{var t=He(J,"defineProperty");return t({},"",{}),t}catch{}}(),rh=m.clearTimeout!==ft.clearTimeout&&m.clearTimeout,ih=T&&T.now!==ft.Date.now&&T.now,sh=m.setTimeout!==ft.setTimeout&&m.setTimeout,cr=ot.ceil,hr=ot.floor,Ai=J.getOwnPropertySymbols,oh=sr?sr.isBuffer:i,Fo=m.isFinite,uh=er.join,ah=Io(J.keys,J),ut=ot.max,gt=ot.min,lh=T.now,ch=m.parseInt,Uo=ot.random,hh=er.reverse,Ci=He(m,"DataView"),Bn=He(m,"Map"),Ei=He(m,"Promise"),en=He(m,"Set"),Tn=He(m,"WeakMap"),An=He(J,"create"),fr=Tn&&new Tn,nn={},fh=Ge(Ci),dh=Ge(Bn),ph=Ge(Ei),gh=Ge(en),_h=Ge(Tn),dr=Te?Te.prototype:i,Cn=dr?dr.valueOf:i,Ho=dr?dr.toString:i;function l(t){if(nt(t)&&!M(t)&&!(t instanceof G)){if(t instanceof Nt)return t;if(X.call(t,"__wrapped__"))return Gu(t)}return new Nt(t)}var rn=function(){function t(){}return function(e){if(!et(e))return{};if(No)return No(e);t.prototype=e;var r=new t;return t.prototype=i,r}}();function pr(){}function Nt(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}l.templateSettings={escape:Ol,evaluate:Rl,interpolate:Vs,variable:"",imports:{_:l}},l.prototype=pr.prototype,l.prototype.constructor=l,Nt.prototype=rn(pr.prototype),Nt.prototype.constructor=Nt;function G(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Qt,this.__views__=[]}function vh(){var t=new G(this.__wrapped__);return t.__actions__=St(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=St(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=St(this.__views__),t}function mh(){if(this.__filtered__){var t=new G(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t}function yh(){var t=this.__wrapped__.value(),e=this.__dir__,r=M(t),s=e<0,a=r?t.length:0,c=If(0,a,this.__views__),h=c.start,d=c.end,g=d-h,w=s?d:h-1,x=this.__iteratees__,S=x.length,B=0,C=gt(g,this.__takeCount__);if(!r||!s&&a==g&&C==g)return hu(t,this.__actions__);var R=[];t:for(;g--&&B<C;){w+=e;for(var W=-1,I=t[w];++W<S;){var H=x[W],q=H.iteratee,Rt=H.type,yt=q(I);if(Rt==dl)I=yt;else if(!yt){if(Rt==$s)continue t;break t}}R[B++]=I}return R}G.prototype=rn(pr.prototype),G.prototype.constructor=G;function De(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var s=t[e];this.set(s[0],s[1])}}function wh(){this.__data__=An?An(null):{},this.size=0}function xh(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}function bh(t){var e=this.__data__;if(An){var r=e[t];return r===L?i:r}return X.call(e,t)?e[t]:i}function Sh(t){var e=this.__data__;return An?e[t]!==i:X.call(e,t)}function Bh(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=An&&e===i?L:e,this}De.prototype.clear=wh,De.prototype.delete=xh,De.prototype.get=bh,De.prototype.has=Sh,De.prototype.set=Bh;function le(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var s=t[e];this.set(s[0],s[1])}}function Th(){this.__data__=[],this.size=0}function Ah(t){var e=this.__data__,r=gr(e,t);if(r<0)return!1;var s=e.length-1;return r==s?e.pop():ar.call(e,r,1),--this.size,!0}function Ch(t){var e=this.__data__,r=gr(e,t);return r<0?i:e[r][1]}function Eh(t){return gr(this.__data__,t)>-1}function Ph(t,e){var r=this.__data__,s=gr(r,t);return s<0?(++this.size,r.push([t,e])):r[s][1]=e,this}le.prototype.clear=Th,le.prototype.delete=Ah,le.prototype.get=Ch,le.prototype.has=Eh,le.prototype.set=Ph;function ce(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var s=t[e];this.set(s[0],s[1])}}function Oh(){this.size=0,this.__data__={hash:new De,map:new(Bn||le),string:new De}}function Rh(t){var e=Cr(this,t).delete(t);return this.size-=e?1:0,e}function Ih(t){return Cr(this,t).get(t)}function Lh(t){return Cr(this,t).has(t)}function kh(t,e){var r=Cr(this,t),s=r.size;return r.set(t,e),this.size+=r.size==s?0:1,this}ce.prototype.clear=Oh,ce.prototype.delete=Rh,ce.prototype.get=Ih,ce.prototype.has=Lh,ce.prototype.set=kh;function We(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new ce;++e<r;)this.add(t[e])}function Mh(t){return this.__data__.set(t,L),this}function Nh(t){return this.__data__.has(t)}We.prototype.add=We.prototype.push=Mh,We.prototype.has=Nh;function Xt(t){var e=this.__data__=new le(t);this.size=e.size}function Dh(){this.__data__=new le,this.size=0}function Wh(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function Fh(t){return this.__data__.get(t)}function Uh(t){return this.__data__.has(t)}function Hh(t,e){var r=this.__data__;if(r instanceof le){var s=r.__data__;if(!Bn||s.length<f-1)return s.push([t,e]),this.size=++r.size,this;r=this.__data__=new ce(s)}return r.set(t,e),this.size=r.size,this}Xt.prototype.clear=Dh,Xt.prototype.delete=Wh,Xt.prototype.get=Fh,Xt.prototype.has=Uh,Xt.prototype.set=Hh;function Go(t,e){var r=M(t),s=!r&&qe(t),a=!r&&!s&&Oe(t),c=!r&&!s&&!a&&an(t),h=r||s||a||c,d=h?bi(t.length,Zc):[],g=d.length;for(var w in t)(e||X.call(t,w))&&!(h&&(w=="length"||a&&(w=="offset"||w=="parent")||c&&(w=="buffer"||w=="byteLength"||w=="byteOffset")||pe(w,g)))&&d.push(w);return d}function qo(t){var e=t.length;return e?t[Fi(0,e-1)]:i}function Gh(t,e){return Er(St(t),Fe(e,0,t.length))}function qh(t){return Er(St(t))}function Pi(t,e,r){(r!==i&&!zt(t[e],r)||r===i&&!(e in t))&&he(t,e,r)}function En(t,e,r){var s=t[e];(!(X.call(t,e)&&zt(s,r))||r===i&&!(e in t))&&he(t,e,r)}function gr(t,e){for(var r=t.length;r--;)if(zt(t[r][0],e))return r;return-1}function $h(t,e,r,s){return Ae(t,function(a,c,h){e(s,a,r(a),h)}),s}function $o(t,e){return t&&te(e,at(e),t)}function Kh(t,e){return t&&te(e,Tt(e),t)}function he(t,e,r){e=="__proto__"&&lr?lr(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Oi(t,e){for(var r=-1,s=e.length,a=v(s),c=t==null;++r<s;)a[r]=c?i:cs(t,e[r]);return a}function Fe(t,e,r){return t===t&&(r!==i&&(t=t<=r?t:r),e!==i&&(t=t>=e?t:e)),t}function Dt(t,e,r,s,a,c){var h,d=e&F,g=e&Zt,w=e&we;if(r&&(h=a?r(t,s,a,c):r(t)),h!==i)return h;if(!et(t))return t;var x=M(t);if(x){if(h=kf(t),!d)return St(t,h)}else{var S=_t(t),B=S==Xn||S==Ks;if(Oe(t))return pu(t,d);if(S==ae||S==Xe||B&&!a){if(h=g||B?{}:Lu(t),!d)return g?Sf(t,Kh(h,t)):bf(t,$o(h,t))}else{if(!Z[S])return a?t:{};h=Mf(t,S,d)}}c||(c=new Xt);var C=c.get(t);if(C)return C;c.set(t,h),aa(t)?t.forEach(function(I){h.add(Dt(I,e,r,I,t,c))}):oa(t)&&t.forEach(function(I,H){h.set(H,Dt(I,e,r,H,t,c))});var R=w?g?Ji:Vi:g?Tt:at,W=x?i:R(t);return kt(W||t,function(I,H){W&&(H=I,I=t[H]),En(h,H,Dt(I,e,r,H,t,c))}),h}function Yh(t){var e=at(t);return function(r){return Ko(r,t,e)}}function Ko(t,e,r){var s=r.length;if(t==null)return!s;for(t=J(t);s--;){var a=r[s],c=e[a],h=t[a];if(h===i&&!(a in t)||!c(h))return!1}return!0}function Yo(t,e,r){if(typeof t!="function")throw new Mt(b);return Mn(function(){t.apply(i,r)},e)}function Pn(t,e,r,s){var a=-1,c=Qn,h=!0,d=t.length,g=[],w=e.length;if(!d)return g;r&&(e=j(e,Et(r))),s?(c=_i,h=!1):e.length>=f&&(c=bn,h=!1,e=new We(e));t:for(;++a<d;){var x=t[a],S=r==null?x:r(x);if(x=s||x!==0?x:0,h&&S===S){for(var B=w;B--;)if(e[B]===S)continue t;g.push(x)}else c(e,S,s)||g.push(x)}return g}var Ae=yu(jt),Xo=yu(Ii,!0);function Xh(t,e){var r=!0;return Ae(t,function(s,a,c){return r=!!e(s,a,c),r}),r}function _r(t,e,r){for(var s=-1,a=t.length;++s<a;){var c=t[s],h=e(c);if(h!=null&&(d===i?h===h&&!Ot(h):r(h,d)))var d=h,g=c}return g}function zh(t,e,r,s){var a=t.length;for(r=N(r),r<0&&(r=-r>a?0:a+r),s=s===i||s>a?a:N(s),s<0&&(s+=a),s=r>s?0:ca(s);r<s;)t[r++]=e;return t}function zo(t,e){var r=[];return Ae(t,function(s,a,c){e(s,a,c)&&r.push(s)}),r}function dt(t,e,r,s,a){var c=-1,h=t.length;for(r||(r=Df),a||(a=[]);++c<h;){var d=t[c];e>0&&r(d)?e>1?dt(d,e-1,r,s,a):Se(a,d):s||(a[a.length]=d)}return a}var Ri=wu(),Vo=wu(!0);function jt(t,e){return t&&Ri(t,e,at)}function Ii(t,e){return t&&Vo(t,e,at)}function vr(t,e){return be(e,function(r){return ge(t[r])})}function Ue(t,e){e=Ee(e,t);for(var r=0,s=e.length;t!=null&&r<s;)t=t[ee(e[r++])];return r&&r==s?t:i}function Jo(t,e,r){var s=e(t);return M(t)?s:Se(s,r(t))}function vt(t){return t==null?t===i?Sl:xl:Ne&&Ne in J(t)?Rf(t):$f(t)}function Li(t,e){return t>e}function Vh(t,e){return t!=null&&X.call(t,e)}function Jh(t,e){return t!=null&&e in J(t)}function Zh(t,e,r){return t>=gt(e,r)&&t<ut(e,r)}function ki(t,e,r){for(var s=r?_i:Qn,a=t[0].length,c=t.length,h=c,d=v(c),g=1/0,w=[];h--;){var x=t[h];h&&e&&(x=j(x,Et(e))),g=gt(x.length,g),d[h]=!r&&(e||a>=120&&x.length>=120)?new We(h&&x):i}x=t[0];var S=-1,B=d[0];t:for(;++S<a&&w.length<g;){var C=x[S],R=e?e(C):C;if(C=r||C!==0?C:0,!(B?bn(B,R):s(w,R,r))){for(h=c;--h;){var W=d[h];if(!(W?bn(W,R):s(t[h],R,r)))continue t}B&&B.push(R),w.push(C)}}return w}function Qh(t,e,r,s){return jt(t,function(a,c,h){e(s,r(a),c,h)}),s}function On(t,e,r){e=Ee(e,t),t=Du(t,e);var s=t==null?t:t[ee(Ft(e))];return s==null?i:Ct(s,t,r)}function Zo(t){return nt(t)&&vt(t)==Xe}function jh(t){return nt(t)&&vt(t)==xn}function tf(t){return nt(t)&&vt(t)==_n}function Rn(t,e,r,s,a){return t===e?!0:t==null||e==null||!nt(t)&&!nt(e)?t!==t&&e!==e:ef(t,e,r,s,Rn,a)}function ef(t,e,r,s,a,c){var h=M(t),d=M(e),g=h?Kn:_t(t),w=d?Kn:_t(e);g=g==Xe?ae:g,w=w==Xe?ae:w;var x=g==ae,S=w==ae,B=g==w;if(B&&Oe(t)){if(!Oe(e))return!1;h=!0,x=!1}if(B&&!x)return c||(c=new Xt),h||an(t)?Ou(t,e,r,s,a,c):Pf(t,e,g,r,s,a,c);if(!(r&xe)){var C=x&&X.call(t,"__wrapped__"),R=S&&X.call(e,"__wrapped__");if(C||R){var W=C?t.value():t,I=R?e.value():e;return c||(c=new Xt),a(W,I,r,s,c)}}return B?(c||(c=new Xt),Of(t,e,r,s,a,c)):!1}function nf(t){return nt(t)&&_t(t)==$t}function Mi(t,e,r,s){var a=r.length,c=a,h=!s;if(t==null)return!c;for(t=J(t);a--;){var d=r[a];if(h&&d[2]?d[1]!==t[d[0]]:!(d[0]in t))return!1}for(;++a<c;){d=r[a];var g=d[0],w=t[g],x=d[1];if(h&&d[2]){if(w===i&&!(g in t))return!1}else{var S=new Xt;if(s)var B=s(w,x,g,t,e,S);if(!(B===i?Rn(x,w,xe|$e,s,S):B))return!1}}return!0}function Qo(t){if(!et(t)||Ff(t))return!1;var e=ge(t)?nh:Yl;return e.test(Ge(t))}function rf(t){return nt(t)&&vt(t)==mn}function sf(t){return nt(t)&&_t(t)==Kt}function of(t){return nt(t)&&kr(t.length)&&!!Q[vt(t)]}function jo(t){return typeof t=="function"?t:t==null?At:typeof t=="object"?M(t)?nu(t[0],t[1]):eu(t):xa(t)}function Ni(t){if(!kn(t))return ah(t);var e=[];for(var r in J(t))X.call(t,r)&&r!="constructor"&&e.push(r);return e}function uf(t){if(!et(t))return qf(t);var e=kn(t),r=[];for(var s in t)s=="constructor"&&(e||!X.call(t,s))||r.push(s);return r}function Di(t,e){return t<e}function tu(t,e){var r=-1,s=Bt(t)?v(t.length):[];return Ae(t,function(a,c,h){s[++r]=e(a,c,h)}),s}function eu(t){var e=Qi(t);return e.length==1&&e[0][2]?Mu(e[0][0],e[0][1]):function(r){return r===t||Mi(r,t,e)}}function nu(t,e){return ts(t)&&ku(e)?Mu(ee(t),e):function(r){var s=cs(r,t);return s===i&&s===e?hs(r,t):Rn(e,s,xe|$e)}}function mr(t,e,r,s,a){t!==e&&Ri(e,function(c,h){if(a||(a=new Xt),et(c))af(t,e,h,r,mr,s,a);else{var d=s?s(ns(t,h),c,h+"",t,e,a):i;d===i&&(d=c),Pi(t,h,d)}},Tt)}function af(t,e,r,s,a,c,h){var d=ns(t,r),g=ns(e,r),w=h.get(g);if(w){Pi(t,r,w);return}var x=c?c(d,g,r+"",t,e,h):i,S=x===i;if(S){var B=M(g),C=!B&&Oe(g),R=!B&&!C&&an(g);x=g,B||C||R?M(d)?x=d:rt(d)?x=St(d):C?(S=!1,x=pu(g,!0)):R?(S=!1,x=gu(g,!0)):x=[]:Nn(g)||qe(g)?(x=d,qe(d)?x=ha(d):(!et(d)||ge(d))&&(x=Lu(g))):S=!1}S&&(h.set(g,x),a(x,g,s,c,h),h.delete(g)),Pi(t,r,x)}function ru(t,e){var r=t.length;if(r)return e+=e<0?r:0,pe(e,r)?t[e]:i}function iu(t,e,r){e.length?e=j(e,function(c){return M(c)?function(h){return Ue(h,c.length===1?c[0]:c)}:c}):e=[At];var s=-1;e=j(e,Et(O()));var a=tu(t,function(c,h,d){var g=j(e,function(w){return w(c)});return{criteria:g,index:++s,value:c}});return kc(a,function(c,h){return xf(c,h,r)})}function lf(t,e){return su(t,e,function(r,s){return hs(t,s)})}function su(t,e,r){for(var s=-1,a=e.length,c={};++s<a;){var h=e[s],d=Ue(t,h);r(d,h)&&In(c,Ee(h,t),d)}return c}function cf(t){return function(e){return Ue(e,t)}}function Wi(t,e,r,s){var a=s?Lc:Je,c=-1,h=e.length,d=t;for(t===e&&(e=St(e)),r&&(d=j(t,Et(r)));++c<h;)for(var g=0,w=e[c],x=r?r(w):w;(g=a(d,x,g,s))>-1;)d!==t&&ar.call(d,g,1),ar.call(t,g,1);return t}function ou(t,e){for(var r=t?e.length:0,s=r-1;r--;){var a=e[r];if(r==s||a!==c){var c=a;pe(a)?ar.call(t,a,1):Gi(t,a)}}return t}function Fi(t,e){return t+hr(Uo()*(e-t+1))}function hf(t,e,r,s){for(var a=-1,c=ut(cr((e-t)/(r||1)),0),h=v(c);c--;)h[s?c:++a]=t,t+=r;return h}function Ui(t,e){var r="";if(!t||e<1||e>Ye)return r;do e%2&&(r+=t),e=hr(e/2),e&&(t+=t);while(e);return r}function U(t,e){return rs(Nu(t,e,At),t+"")}function ff(t){return qo(ln(t))}function df(t,e){var r=ln(t);return Er(r,Fe(e,0,r.length))}function In(t,e,r,s){if(!et(t))return t;e=Ee(e,t);for(var a=-1,c=e.length,h=c-1,d=t;d!=null&&++a<c;){var g=ee(e[a]),w=r;if(g==="__proto__"||g==="constructor"||g==="prototype")return t;if(a!=h){var x=d[g];w=s?s(x,g,d):i,w===i&&(w=et(x)?x:pe(e[a+1])?[]:{})}En(d,g,w),d=d[g]}return t}var uu=fr?function(t,e){return fr.set(t,e),t}:At,pf=lr?function(t,e){return lr(t,"toString",{configurable:!0,enumerable:!1,value:ds(e),writable:!0})}:At;function gf(t){return Er(ln(t))}function Wt(t,e,r){var s=-1,a=t.length;e<0&&(e=-e>a?0:a+e),r=r>a?a:r,r<0&&(r+=a),a=e>r?0:r-e>>>0,e>>>=0;for(var c=v(a);++s<a;)c[s]=t[s+e];return c}function _f(t,e){var r;return Ae(t,function(s,a,c){return r=e(s,a,c),!r}),!!r}function yr(t,e,r){var s=0,a=t==null?s:t.length;if(typeof e=="number"&&e===e&&a<=vl){for(;s<a;){var c=s+a>>>1,h=t[c];h!==null&&!Ot(h)&&(r?h<=e:h<e)?s=c+1:a=c}return a}return Hi(t,e,At,r)}function Hi(t,e,r,s){var a=0,c=t==null?0:t.length;if(c===0)return 0;e=r(e);for(var h=e!==e,d=e===null,g=Ot(e),w=e===i;a<c;){var x=hr((a+c)/2),S=r(t[x]),B=S!==i,C=S===null,R=S===S,W=Ot(S);if(h)var I=s||R;else w?I=R&&(s||B):d?I=R&&B&&(s||!C):g?I=R&&B&&!C&&(s||!W):C||W?I=!1:I=s?S<=e:S<e;I?a=x+1:c=x}return gt(c,_l)}function au(t,e){for(var r=-1,s=t.length,a=0,c=[];++r<s;){var h=t[r],d=e?e(h):h;if(!r||!zt(d,g)){var g=d;c[a++]=h===0?0:h}}return c}function lu(t){return typeof t=="number"?t:Ot(t)?$n:+t}function Pt(t){if(typeof t=="string")return t;if(M(t))return j(t,Pt)+"";if(Ot(t))return Ho?Ho.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function Ce(t,e,r){var s=-1,a=Qn,c=t.length,h=!0,d=[],g=d;if(r)h=!1,a=_i;else if(c>=f){var w=e?null:Cf(t);if(w)return tr(w);h=!1,a=bn,g=new We}else g=e?[]:d;t:for(;++s<c;){var x=t[s],S=e?e(x):x;if(x=r||x!==0?x:0,h&&S===S){for(var B=g.length;B--;)if(g[B]===S)continue t;e&&g.push(S),d.push(x)}else a(g,S,r)||(g!==d&&g.push(S),d.push(x))}return d}function Gi(t,e){return e=Ee(e,t),t=Du(t,e),t==null||delete t[ee(Ft(e))]}function cu(t,e,r,s){return In(t,e,r(Ue(t,e)),s)}function wr(t,e,r,s){for(var a=t.length,c=s?a:-1;(s?c--:++c<a)&&e(t[c],c,t););return r?Wt(t,s?0:c,s?c+1:a):Wt(t,s?c+1:0,s?a:c)}function hu(t,e){var r=t;return r instanceof G&&(r=r.value()),vi(e,function(s,a){return a.func.apply(a.thisArg,Se([s],a.args))},r)}function qi(t,e,r){var s=t.length;if(s<2)return s?Ce(t[0]):[];for(var a=-1,c=v(s);++a<s;)for(var h=t[a],d=-1;++d<s;)d!=a&&(c[a]=Pn(c[a]||h,t[d],e,r));return Ce(dt(c,1),e,r)}function fu(t,e,r){for(var s=-1,a=t.length,c=e.length,h={};++s<a;){var d=s<c?e[s]:i;r(h,t[s],d)}return h}function $i(t){return rt(t)?t:[]}function Ki(t){return typeof t=="function"?t:At}function Ee(t,e){return M(t)?t:ts(t,e)?[t]:Hu(Y(t))}var vf=U;function Pe(t,e,r){var s=t.length;return r=r===i?s:r,!e&&r>=s?t:Wt(t,e,r)}var du=rh||function(t){return ft.clearTimeout(t)};function pu(t,e){if(e)return t.slice();var r=t.length,s=Mo?Mo(r):new t.constructor(r);return t.copy(s),s}function Yi(t){var e=new t.constructor(t.byteLength);return new or(e).set(new or(t)),e}function mf(t,e){var r=e?Yi(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}function yf(t){var e=new t.constructor(t.source,Js.exec(t));return e.lastIndex=t.lastIndex,e}function wf(t){return Cn?J(Cn.call(t)):{}}function gu(t,e){var r=e?Yi(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function _u(t,e){if(t!==e){var r=t!==i,s=t===null,a=t===t,c=Ot(t),h=e!==i,d=e===null,g=e===e,w=Ot(e);if(!d&&!w&&!c&&t>e||c&&h&&g&&!d&&!w||s&&h&&g||!r&&g||!a)return 1;if(!s&&!c&&!w&&t<e||w&&r&&a&&!s&&!c||d&&r&&a||!h&&a||!g)return-1}return 0}function xf(t,e,r){for(var s=-1,a=t.criteria,c=e.criteria,h=a.length,d=r.length;++s<h;){var g=_u(a[s],c[s]);if(g){if(s>=d)return g;var w=r[s];return g*(w=="desc"?-1:1)}}return t.index-e.index}function vu(t,e,r,s){for(var a=-1,c=t.length,h=r.length,d=-1,g=e.length,w=ut(c-h,0),x=v(g+w),S=!s;++d<g;)x[d]=e[d];for(;++a<h;)(S||a<c)&&(x[r[a]]=t[a]);for(;w--;)x[d++]=t[a++];return x}function mu(t,e,r,s){for(var a=-1,c=t.length,h=-1,d=r.length,g=-1,w=e.length,x=ut(c-d,0),S=v(x+w),B=!s;++a<x;)S[a]=t[a];for(var C=a;++g<w;)S[C+g]=e[g];for(;++h<d;)(B||a<c)&&(S[C+r[h]]=t[a++]);return S}function St(t,e){var r=-1,s=t.length;for(e||(e=v(s));++r<s;)e[r]=t[r];return e}function te(t,e,r,s){var a=!r;r||(r={});for(var c=-1,h=e.length;++c<h;){var d=e[c],g=s?s(r[d],t[d],d,r,t):i;g===i&&(g=t[d]),a?he(r,d,g):En(r,d,g)}return r}function bf(t,e){return te(t,ji(t),e)}function Sf(t,e){return te(t,Ru(t),e)}function xr(t,e){return function(r,s){var a=M(r)?Cc:$h,c=e?e():{};return a(r,t,O(s,2),c)}}function sn(t){return U(function(e,r){var s=-1,a=r.length,c=a>1?r[a-1]:i,h=a>2?r[2]:i;for(c=t.length>3&&typeof c=="function"?(a--,c):i,h&&mt(r[0],r[1],h)&&(c=a<3?i:c,a=1),e=J(e);++s<a;){var d=r[s];d&&t(e,d,s,c)}return e})}function yu(t,e){return function(r,s){if(r==null)return r;if(!Bt(r))return t(r,s);for(var a=r.length,c=e?a:-1,h=J(r);(e?c--:++c<a)&&s(h[c],c,h)!==!1;);return r}}function wu(t){return function(e,r,s){for(var a=-1,c=J(e),h=s(e),d=h.length;d--;){var g=h[t?d:++a];if(r(c[g],g,c)===!1)break}return e}}function Bf(t,e,r){var s=e&qt,a=Ln(t);function c(){var h=this&&this!==ft&&this instanceof c?a:t;return h.apply(s?r:this,arguments)}return c}function xu(t){return function(e){e=Y(e);var r=Ze(e)?Yt(e):i,s=r?r[0]:e.charAt(0),a=r?Pe(r,1).join(""):e.slice(1);return s[t]()+a}}function on(t){return function(e){return vi(ya(ma(e).replace(dc,"")),t,"")}}function Ln(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=rn(t.prototype),s=t.apply(r,e);return et(s)?s:r}}function Tf(t,e,r){var s=Ln(t);function a(){for(var c=arguments.length,h=v(c),d=c,g=un(a);d--;)h[d]=arguments[d];var w=c<3&&h[0]!==g&&h[c-1]!==g?[]:Be(h,g);if(c-=w.length,c<r)return Au(t,e,br,a.placeholder,i,h,w,i,i,r-c);var x=this&&this!==ft&&this instanceof a?s:t;return Ct(x,this,h)}return a}function bu(t){return function(e,r,s){var a=J(e);if(!Bt(e)){var c=O(r,3);e=at(e),r=function(d){return c(a[d],d,a)}}var h=t(e,r,s);return h>-1?a[c?e[h]:h]:i}}function Su(t){return de(function(e){var r=e.length,s=r,a=Nt.prototype.thru;for(t&&e.reverse();s--;){var c=e[s];if(typeof c!="function")throw new Mt(b);if(a&&!h&&Ar(c)=="wrapper")var h=new Nt([],!0)}for(s=h?s:r;++s<r;){c=e[s];var d=Ar(c),g=d=="wrapper"?Zi(c):i;g&&es(g[0])&&g[1]==(ue|se|oe|pn)&&!g[4].length&&g[9]==1?h=h[Ar(g[0])].apply(h,g[3]):h=c.length==1&&es(c)?h[d]():h.thru(c)}return function(){var w=arguments,x=w[0];if(h&&w.length==1&&M(x))return h.plant(x).value();for(var S=0,B=r?e[S].apply(this,w):x;++S<r;)B=e[S].call(this,B);return B}})}function br(t,e,r,s,a,c,h,d,g,w){var x=e&ue,S=e&qt,B=e&Ke,C=e&(se|fn),R=e&Zr,W=B?i:Ln(t);function I(){for(var H=arguments.length,q=v(H),Rt=H;Rt--;)q[Rt]=arguments[Rt];if(C)var yt=un(I),It=Nc(q,yt);if(s&&(q=vu(q,s,a,C)),c&&(q=mu(q,c,h,C)),H-=It,C&&H<w){var it=Be(q,yt);return Au(t,e,br,I.placeholder,r,q,it,d,g,w-H)}var Vt=S?r:this,ve=B?Vt[t]:t;return H=q.length,d?q=Kf(q,d):R&&H>1&&q.reverse(),x&&g<H&&(q.length=g),this&&this!==ft&&this instanceof I&&(ve=W||Ln(ve)),ve.apply(Vt,q)}return I}function Bu(t,e){return function(r,s){return Qh(r,t,e(s),{})}}function Sr(t,e){return function(r,s){var a;if(r===i&&s===i)return e;if(r!==i&&(a=r),s!==i){if(a===i)return s;typeof r=="string"||typeof s=="string"?(r=Pt(r),s=Pt(s)):(r=lu(r),s=lu(s)),a=t(r,s)}return a}}function Xi(t){return de(function(e){return e=j(e,Et(O())),U(function(r){var s=this;return t(e,function(a){return Ct(a,s,r)})})})}function Br(t,e){e=e===i?" ":Pt(e);var r=e.length;if(r<2)return r?Ui(e,t):e;var s=Ui(e,cr(t/Qe(e)));return Ze(e)?Pe(Yt(s),0,t).join(""):s.slice(0,t)}function Af(t,e,r,s){var a=e&qt,c=Ln(t);function h(){for(var d=-1,g=arguments.length,w=-1,x=s.length,S=v(x+g),B=this&&this!==ft&&this instanceof h?c:t;++w<x;)S[w]=s[w];for(;g--;)S[w++]=arguments[++d];return Ct(B,a?r:this,S)}return h}function Tu(t){return function(e,r,s){return s&&typeof s!="number"&&mt(e,r,s)&&(r=s=i),e=_e(e),r===i?(r=e,e=0):r=_e(r),s=s===i?e<r?1:-1:_e(s),hf(e,r,s,t)}}function Tr(t){return function(e,r){return typeof e=="string"&&typeof r=="string"||(e=Ut(e),r=Ut(r)),t(e,r)}}function Au(t,e,r,s,a,c,h,d,g,w){var x=e&se,S=x?h:i,B=x?i:h,C=x?c:i,R=x?i:c;e|=x?oe:dn,e&=~(x?dn:oe),e&qs||(e&=-4);var W=[t,e,a,C,S,R,B,d,g,w],I=r.apply(i,W);return es(t)&&Wu(I,W),I.placeholder=s,Fu(I,t,e)}function zi(t){var e=ot[t];return function(r,s){if(r=Ut(r),s=s==null?0:gt(N(s),292),s&&Fo(r)){var a=(Y(r)+"e").split("e"),c=e(a[0]+"e"+(+a[1]+s));return a=(Y(c)+"e").split("e"),+(a[0]+"e"+(+a[1]-s))}return e(r)}}var Cf=en&&1/tr(new en([,-0]))[1]==qn?function(t){return new en(t)}:_s;function Cu(t){return function(e){var r=_t(e);return r==$t?Bi(e):r==Kt?qc(e):Mc(e,t(e))}}function fe(t,e,r,s,a,c,h,d){var g=e&Ke;if(!g&&typeof t!="function")throw new Mt(b);var w=s?s.length:0;if(w||(e&=-97,s=a=i),h=h===i?h:ut(N(h),0),d=d===i?d:N(d),w-=a?a.length:0,e&dn){var x=s,S=a;s=a=i}var B=g?i:Zi(t),C=[t,e,r,s,a,x,S,c,h,d];if(B&&Gf(C,B),t=C[0],e=C[1],r=C[2],s=C[3],a=C[4],d=C[9]=C[9]===i?g?0:t.length:ut(C[9]-w,0),!d&&e&(se|fn)&&(e&=-25),!e||e==qt)var R=Bf(t,e,r);else e==se||e==fn?R=Tf(t,e,d):(e==oe||e==(qt|oe))&&!a.length?R=Af(t,e,r,s):R=br.apply(i,C);var W=B?uu:Wu;return Fu(W(R,C),t,e)}function Eu(t,e,r,s){return t===i||zt(t,tn[r])&&!X.call(s,r)?e:t}function Pu(t,e,r,s,a,c){return et(t)&&et(e)&&(c.set(e,t),mr(t,e,i,Pu,c),c.delete(e)),t}function Ef(t){return Nn(t)?i:t}function Ou(t,e,r,s,a,c){var h=r&xe,d=t.length,g=e.length;if(d!=g&&!(h&&g>d))return!1;var w=c.get(t),x=c.get(e);if(w&&x)return w==e&&x==t;var S=-1,B=!0,C=r&$e?new We:i;for(c.set(t,e),c.set(e,t);++S<d;){var R=t[S],W=e[S];if(s)var I=h?s(W,R,S,e,t,c):s(R,W,S,t,e,c);if(I!==i){if(I)continue;B=!1;break}if(C){if(!mi(e,function(H,q){if(!bn(C,q)&&(R===H||a(R,H,r,s,c)))return C.push(q)})){B=!1;break}}else if(!(R===W||a(R,W,r,s,c))){B=!1;break}}return c.delete(t),c.delete(e),B}function Pf(t,e,r,s,a,c,h){switch(r){case ze:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case xn:return!(t.byteLength!=e.byteLength||!c(new or(t),new or(e)));case gn:case _n:case vn:return zt(+t,+e);case Yn:return t.name==e.name&&t.message==e.message;case mn:case yn:return t==e+"";case $t:var d=Bi;case Kt:var g=s&xe;if(d||(d=tr),t.size!=e.size&&!g)return!1;var w=h.get(t);if(w)return w==e;s|=$e,h.set(t,e);var x=Ou(d(t),d(e),s,a,c,h);return h.delete(t),x;case zn:if(Cn)return Cn.call(t)==Cn.call(e)}return!1}function Of(t,e,r,s,a,c){var h=r&xe,d=Vi(t),g=d.length,w=Vi(e),x=w.length;if(g!=x&&!h)return!1;for(var S=g;S--;){var B=d[S];if(!(h?B in e:X.call(e,B)))return!1}var C=c.get(t),R=c.get(e);if(C&&R)return C==e&&R==t;var W=!0;c.set(t,e),c.set(e,t);for(var I=h;++S<g;){B=d[S];var H=t[B],q=e[B];if(s)var Rt=h?s(q,H,B,e,t,c):s(H,q,B,t,e,c);if(!(Rt===i?H===q||a(H,q,r,s,c):Rt)){W=!1;break}I||(I=B=="constructor")}if(W&&!I){var yt=t.constructor,It=e.constructor;yt!=It&&"constructor"in t&&"constructor"in e&&!(typeof yt=="function"&&yt instanceof yt&&typeof It=="function"&&It instanceof It)&&(W=!1)}return c.delete(t),c.delete(e),W}function de(t){return rs(Nu(t,i,Ku),t+"")}function Vi(t){return Jo(t,at,ji)}function Ji(t){return Jo(t,Tt,Ru)}var Zi=fr?function(t){return fr.get(t)}:_s;function Ar(t){for(var e=t.name+"",r=nn[e],s=X.call(nn,e)?r.length:0;s--;){var a=r[s],c=a.func;if(c==null||c==t)return a.name}return e}function un(t){var e=X.call(l,"placeholder")?l:t;return e.placeholder}function O(){var t=l.iteratee||ps;return t=t===ps?jo:t,arguments.length?t(arguments[0],arguments[1]):t}function Cr(t,e){var r=t.__data__;return Wf(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Qi(t){for(var e=at(t),r=e.length;r--;){var s=e[r],a=t[s];e[r]=[s,a,ku(a)]}return e}function He(t,e){var r=Uc(t,e);return Qo(r)?r:i}function Rf(t){var e=X.call(t,Ne),r=t[Ne];try{t[Ne]=i;var s=!0}catch{}var a=ir.call(t);return s&&(e?t[Ne]=r:delete t[Ne]),a}var ji=Ai?function(t){return t==null?[]:(t=J(t),be(Ai(t),function(e){return Do.call(t,e)}))}:vs,Ru=Ai?function(t){for(var e=[];t;)Se(e,ji(t)),t=ur(t);return e}:vs,_t=vt;(Ci&&_t(new Ci(new ArrayBuffer(1)))!=ze||Bn&&_t(new Bn)!=$t||Ei&&_t(Ei.resolve())!=Ys||en&&_t(new en)!=Kt||Tn&&_t(new Tn)!=wn)&&(_t=function(t){var e=vt(t),r=e==ae?t.constructor:i,s=r?Ge(r):"";if(s)switch(s){case fh:return ze;case dh:return $t;case ph:return Ys;case gh:return Kt;case _h:return wn}return e});function If(t,e,r){for(var s=-1,a=r.length;++s<a;){var c=r[s],h=c.size;switch(c.type){case"drop":t+=h;break;case"dropRight":e-=h;break;case"take":e=gt(e,t+h);break;case"takeRight":t=ut(t,e-h);break}}return{start:t,end:e}}function Lf(t){var e=t.match(Wl);return e?e[1].split(Fl):[]}function Iu(t,e,r){e=Ee(e,t);for(var s=-1,a=e.length,c=!1;++s<a;){var h=ee(e[s]);if(!(c=t!=null&&r(t,h)))break;t=t[h]}return c||++s!=a?c:(a=t==null?0:t.length,!!a&&kr(a)&&pe(h,a)&&(M(t)||qe(t)))}function kf(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&X.call(t,"index")&&(r.index=t.index,r.input=t.input),r}function Lu(t){return typeof t.constructor=="function"&&!kn(t)?rn(ur(t)):{}}function Mf(t,e,r){var s=t.constructor;switch(e){case xn:return Yi(t);case gn:case _n:return new s(+t);case ze:return mf(t,r);case Qr:case jr:case ti:case ei:case ni:case ri:case ii:case si:case oi:return gu(t,r);case $t:return new s;case vn:case yn:return new s(t);case mn:return yf(t);case Kt:return new s;case zn:return wf(t)}}function Nf(t,e){var r=e.length;if(!r)return t;var s=r-1;return e[s]=(r>1?"& ":"")+e[s],e=e.join(r>2?", ":" "),t.replace(Dl,`{
/* [wrapped with `+e+`] */
`)}function Df(t){return M(t)||qe(t)||!!(Wo&&t&&t[Wo])}function pe(t,e){var r=typeof t;return e=e??Ye,!!e&&(r=="number"||r!="symbol"&&zl.test(t))&&t>-1&&t%1==0&&t<e}function mt(t,e,r){if(!et(r))return!1;var s=typeof e;return(s=="number"?Bt(r)&&pe(e,r.length):s=="string"&&e in r)?zt(r[e],t):!1}function ts(t,e){if(M(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Ot(t)?!0:Ll.test(t)||!Il.test(t)||e!=null&&t in J(e)}function Wf(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function es(t){var e=Ar(t),r=l[e];if(typeof r!="function"||!(e in G.prototype))return!1;if(t===r)return!0;var s=Zi(r);return!!s&&t===s[0]}function Ff(t){return!!ko&&ko in t}var Uf=nr?ge:ms;function kn(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||tn;return t===r}function ku(t){return t===t&&!et(t)}function Mu(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==i||t in J(r))}}function Hf(t){var e=Ir(t,function(s){return r.size===ht&&r.clear(),s}),r=e.cache;return e}function Gf(t,e){var r=t[1],s=e[1],a=r|s,c=a<(qt|Ke|ue),h=s==ue&&r==se||s==ue&&r==pn&&t[7].length<=e[8]||s==(ue|pn)&&e[7].length<=e[8]&&r==se;if(!(c||h))return t;s&qt&&(t[2]=e[2],a|=r&qt?0:qs);var d=e[3];if(d){var g=t[3];t[3]=g?vu(g,d,e[4]):d,t[4]=g?Be(t[3],tt):e[4]}return d=e[5],d&&(g=t[5],t[5]=g?mu(g,d,e[6]):d,t[6]=g?Be(t[5],tt):e[6]),d=e[7],d&&(t[7]=d),s&ue&&(t[8]=t[8]==null?e[8]:gt(t[8],e[8])),t[9]==null&&(t[9]=e[9]),t[0]=e[0],t[1]=a,t}function qf(t){var e=[];if(t!=null)for(var r in J(t))e.push(r);return e}function $f(t){return ir.call(t)}function Nu(t,e,r){return e=ut(e===i?t.length-1:e,0),function(){for(var s=arguments,a=-1,c=ut(s.length-e,0),h=v(c);++a<c;)h[a]=s[e+a];a=-1;for(var d=v(e+1);++a<e;)d[a]=s[a];return d[e]=r(h),Ct(t,this,d)}}function Du(t,e){return e.length<2?t:Ue(t,Wt(e,0,-1))}function Kf(t,e){for(var r=t.length,s=gt(e.length,r),a=St(t);s--;){var c=e[s];t[s]=pe(c,r)?a[c]:i}return t}function ns(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var Wu=Uu(uu),Mn=sh||function(t,e){return ft.setTimeout(t,e)},rs=Uu(pf);function Fu(t,e,r){var s=e+"";return rs(t,Nf(s,Yf(Lf(s),r)))}function Uu(t){var e=0,r=0;return function(){var s=lh(),a=fl-(s-r);if(r=s,a>0){if(++e>=hl)return arguments[0]}else e=0;return t.apply(i,arguments)}}function Er(t,e){var r=-1,s=t.length,a=s-1;for(e=e===i?s:e;++r<e;){var c=Fi(r,a),h=t[c];t[c]=t[r],t[r]=h}return t.length=e,t}var Hu=Hf(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(kl,function(r,s,a,c){e.push(a?c.replace(Gl,"$1"):s||r)}),e});function ee(t){if(typeof t=="string"||Ot(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function Ge(t){if(t!=null){try{return rr.call(t)}catch{}try{return t+""}catch{}}return""}function Yf(t,e){return kt(ml,function(r){var s="_."+r[0];e&r[1]&&!Qn(t,s)&&t.push(s)}),t.sort()}function Gu(t){if(t instanceof G)return t.clone();var e=new Nt(t.__wrapped__,t.__chain__);return e.__actions__=St(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}function Xf(t,e,r){(r?mt(t,e,r):e===i)?e=1:e=ut(N(e),0);var s=t==null?0:t.length;if(!s||e<1)return[];for(var a=0,c=0,h=v(cr(s/e));a<s;)h[c++]=Wt(t,a,a+=e);return h}function zf(t){for(var e=-1,r=t==null?0:t.length,s=0,a=[];++e<r;){var c=t[e];c&&(a[s++]=c)}return a}function Vf(){var t=arguments.length;if(!t)return[];for(var e=v(t-1),r=arguments[0],s=t;s--;)e[s-1]=arguments[s];return Se(M(r)?St(r):[r],dt(e,1))}var Jf=U(function(t,e){return rt(t)?Pn(t,dt(e,1,rt,!0)):[]}),Zf=U(function(t,e){var r=Ft(e);return rt(r)&&(r=i),rt(t)?Pn(t,dt(e,1,rt,!0),O(r,2)):[]}),Qf=U(function(t,e){var r=Ft(e);return rt(r)&&(r=i),rt(t)?Pn(t,dt(e,1,rt,!0),i,r):[]});function jf(t,e,r){var s=t==null?0:t.length;return s?(e=r||e===i?1:N(e),Wt(t,e<0?0:e,s)):[]}function td(t,e,r){var s=t==null?0:t.length;return s?(e=r||e===i?1:N(e),e=s-e,Wt(t,0,e<0?0:e)):[]}function ed(t,e){return t&&t.length?wr(t,O(e,3),!0,!0):[]}function nd(t,e){return t&&t.length?wr(t,O(e,3),!0):[]}function rd(t,e,r,s){var a=t==null?0:t.length;return a?(r&&typeof r!="number"&&mt(t,e,r)&&(r=0,s=a),zh(t,e,r,s)):[]}function qu(t,e,r){var s=t==null?0:t.length;if(!s)return-1;var a=r==null?0:N(r);return a<0&&(a=ut(s+a,0)),jn(t,O(e,3),a)}function $u(t,e,r){var s=t==null?0:t.length;if(!s)return-1;var a=s-1;return r!==i&&(a=N(r),a=r<0?ut(s+a,0):gt(a,s-1)),jn(t,O(e,3),a,!0)}function Ku(t){var e=t==null?0:t.length;return e?dt(t,1):[]}function id(t){var e=t==null?0:t.length;return e?dt(t,qn):[]}function sd(t,e){var r=t==null?0:t.length;return r?(e=e===i?1:N(e),dt(t,e)):[]}function od(t){for(var e=-1,r=t==null?0:t.length,s={};++e<r;){var a=t[e];s[a[0]]=a[1]}return s}function Yu(t){return t&&t.length?t[0]:i}function ud(t,e,r){var s=t==null?0:t.length;if(!s)return-1;var a=r==null?0:N(r);return a<0&&(a=ut(s+a,0)),Je(t,e,a)}function ad(t){var e=t==null?0:t.length;return e?Wt(t,0,-1):[]}var ld=U(function(t){var e=j(t,$i);return e.length&&e[0]===t[0]?ki(e):[]}),cd=U(function(t){var e=Ft(t),r=j(t,$i);return e===Ft(r)?e=i:r.pop(),r.length&&r[0]===t[0]?ki(r,O(e,2)):[]}),hd=U(function(t){var e=Ft(t),r=j(t,$i);return e=typeof e=="function"?e:i,e&&r.pop(),r.length&&r[0]===t[0]?ki(r,i,e):[]});function fd(t,e){return t==null?"":uh.call(t,e)}function Ft(t){var e=t==null?0:t.length;return e?t[e-1]:i}function dd(t,e,r){var s=t==null?0:t.length;if(!s)return-1;var a=s;return r!==i&&(a=N(r),a=a<0?ut(s+a,0):gt(a,s-1)),e===e?Kc(t,e,a):jn(t,Ao,a,!0)}function pd(t,e){return t&&t.length?ru(t,N(e)):i}var gd=U(Xu);function Xu(t,e){return t&&t.length&&e&&e.length?Wi(t,e):t}function _d(t,e,r){return t&&t.length&&e&&e.length?Wi(t,e,O(r,2)):t}function vd(t,e,r){return t&&t.length&&e&&e.length?Wi(t,e,i,r):t}var md=de(function(t,e){var r=t==null?0:t.length,s=Oi(t,e);return ou(t,j(e,function(a){return pe(a,r)?+a:a}).sort(_u)),s});function yd(t,e){var r=[];if(!(t&&t.length))return r;var s=-1,a=[],c=t.length;for(e=O(e,3);++s<c;){var h=t[s];e(h,s,t)&&(r.push(h),a.push(s))}return ou(t,a),r}function is(t){return t==null?t:hh.call(t)}function wd(t,e,r){var s=t==null?0:t.length;return s?(r&&typeof r!="number"&&mt(t,e,r)?(e=0,r=s):(e=e==null?0:N(e),r=r===i?s:N(r)),Wt(t,e,r)):[]}function xd(t,e){return yr(t,e)}function bd(t,e,r){return Hi(t,e,O(r,2))}function Sd(t,e){var r=t==null?0:t.length;if(r){var s=yr(t,e);if(s<r&&zt(t[s],e))return s}return-1}function Bd(t,e){return yr(t,e,!0)}function Td(t,e,r){return Hi(t,e,O(r,2),!0)}function Ad(t,e){var r=t==null?0:t.length;if(r){var s=yr(t,e,!0)-1;if(zt(t[s],e))return s}return-1}function Cd(t){return t&&t.length?au(t):[]}function Ed(t,e){return t&&t.length?au(t,O(e,2)):[]}function Pd(t){var e=t==null?0:t.length;return e?Wt(t,1,e):[]}function Od(t,e,r){return t&&t.length?(e=r||e===i?1:N(e),Wt(t,0,e<0?0:e)):[]}function Rd(t,e,r){var s=t==null?0:t.length;return s?(e=r||e===i?1:N(e),e=s-e,Wt(t,e<0?0:e,s)):[]}function Id(t,e){return t&&t.length?wr(t,O(e,3),!1,!0):[]}function Ld(t,e){return t&&t.length?wr(t,O(e,3)):[]}var kd=U(function(t){return Ce(dt(t,1,rt,!0))}),Md=U(function(t){var e=Ft(t);return rt(e)&&(e=i),Ce(dt(t,1,rt,!0),O(e,2))}),Nd=U(function(t){var e=Ft(t);return e=typeof e=="function"?e:i,Ce(dt(t,1,rt,!0),i,e)});function Dd(t){return t&&t.length?Ce(t):[]}function Wd(t,e){return t&&t.length?Ce(t,O(e,2)):[]}function Fd(t,e){return e=typeof e=="function"?e:i,t&&t.length?Ce(t,i,e):[]}function ss(t){if(!(t&&t.length))return[];var e=0;return t=be(t,function(r){if(rt(r))return e=ut(r.length,e),!0}),bi(e,function(r){return j(t,yi(r))})}function zu(t,e){if(!(t&&t.length))return[];var r=ss(t);return e==null?r:j(r,function(s){return Ct(e,i,s)})}var Ud=U(function(t,e){return rt(t)?Pn(t,e):[]}),Hd=U(function(t){return qi(be(t,rt))}),Gd=U(function(t){var e=Ft(t);return rt(e)&&(e=i),qi(be(t,rt),O(e,2))}),qd=U(function(t){var e=Ft(t);return e=typeof e=="function"?e:i,qi(be(t,rt),i,e)}),$d=U(ss);function Kd(t,e){return fu(t||[],e||[],En)}function Yd(t,e){return fu(t||[],e||[],In)}var Xd=U(function(t){var e=t.length,r=e>1?t[e-1]:i;return r=typeof r=="function"?(t.pop(),r):i,zu(t,r)});function Vu(t){var e=l(t);return e.__chain__=!0,e}function zd(t,e){return e(t),t}function Pr(t,e){return e(t)}var Vd=de(function(t){var e=t.length,r=e?t[0]:0,s=this.__wrapped__,a=function(c){return Oi(c,t)};return e>1||this.__actions__.length||!(s instanceof G)||!pe(r)?this.thru(a):(s=s.slice(r,+r+(e?1:0)),s.__actions__.push({func:Pr,args:[a],thisArg:i}),new Nt(s,this.__chain__).thru(function(c){return e&&!c.length&&c.push(i),c}))});function Jd(){return Vu(this)}function Zd(){return new Nt(this.value(),this.__chain__)}function Qd(){this.__values__===i&&(this.__values__=la(this.value()));var t=this.__index__>=this.__values__.length,e=t?i:this.__values__[this.__index__++];return{done:t,value:e}}function jd(){return this}function tp(t){for(var e,r=this;r instanceof pr;){var s=Gu(r);s.__index__=0,s.__values__=i,e?a.__wrapped__=s:e=s;var a=s;r=r.__wrapped__}return a.__wrapped__=t,e}function ep(){var t=this.__wrapped__;if(t instanceof G){var e=t;return this.__actions__.length&&(e=new G(this)),e=e.reverse(),e.__actions__.push({func:Pr,args:[is],thisArg:i}),new Nt(e,this.__chain__)}return this.thru(is)}function np(){return hu(this.__wrapped__,this.__actions__)}var rp=xr(function(t,e,r){X.call(t,r)?++t[r]:he(t,r,1)});function ip(t,e,r){var s=M(t)?Bo:Xh;return r&&mt(t,e,r)&&(e=i),s(t,O(e,3))}function sp(t,e){var r=M(t)?be:zo;return r(t,O(e,3))}var op=bu(qu),up=bu($u);function ap(t,e){return dt(Or(t,e),1)}function lp(t,e){return dt(Or(t,e),qn)}function cp(t,e,r){return r=r===i?1:N(r),dt(Or(t,e),r)}function Ju(t,e){var r=M(t)?kt:Ae;return r(t,O(e,3))}function Zu(t,e){var r=M(t)?Ec:Xo;return r(t,O(e,3))}var hp=xr(function(t,e,r){X.call(t,r)?t[r].push(e):he(t,r,[e])});function fp(t,e,r,s){t=Bt(t)?t:ln(t),r=r&&!s?N(r):0;var a=t.length;return r<0&&(r=ut(a+r,0)),Mr(t)?r<=a&&t.indexOf(e,r)>-1:!!a&&Je(t,e,r)>-1}var dp=U(function(t,e,r){var s=-1,a=typeof e=="function",c=Bt(t)?v(t.length):[];return Ae(t,function(h){c[++s]=a?Ct(e,h,r):On(h,e,r)}),c}),pp=xr(function(t,e,r){he(t,r,e)});function Or(t,e){var r=M(t)?j:tu;return r(t,O(e,3))}function gp(t,e,r,s){return t==null?[]:(M(e)||(e=e==null?[]:[e]),r=s?i:r,M(r)||(r=r==null?[]:[r]),iu(t,e,r))}var _p=xr(function(t,e,r){t[r?0:1].push(e)},function(){return[[],[]]});function vp(t,e,r){var s=M(t)?vi:Eo,a=arguments.length<3;return s(t,O(e,4),r,a,Ae)}function mp(t,e,r){var s=M(t)?Pc:Eo,a=arguments.length<3;return s(t,O(e,4),r,a,Xo)}function yp(t,e){var r=M(t)?be:zo;return r(t,Lr(O(e,3)))}function wp(t){var e=M(t)?qo:ff;return e(t)}function xp(t,e,r){(r?mt(t,e,r):e===i)?e=1:e=N(e);var s=M(t)?Gh:df;return s(t,e)}function bp(t){var e=M(t)?qh:gf;return e(t)}function Sp(t){if(t==null)return 0;if(Bt(t))return Mr(t)?Qe(t):t.length;var e=_t(t);return e==$t||e==Kt?t.size:Ni(t).length}function Bp(t,e,r){var s=M(t)?mi:_f;return r&&mt(t,e,r)&&(e=i),s(t,O(e,3))}var Tp=U(function(t,e){if(t==null)return[];var r=e.length;return r>1&&mt(t,e[0],e[1])?e=[]:r>2&&mt(e[0],e[1],e[2])&&(e=[e[0]]),iu(t,dt(e,1),[])}),Rr=ih||function(){return ft.Date.now()};function Ap(t,e){if(typeof e!="function")throw new Mt(b);return t=N(t),function(){if(--t<1)return e.apply(this,arguments)}}function Qu(t,e,r){return e=r?i:e,e=t&&e==null?t.length:e,fe(t,ue,i,i,i,i,e)}function ju(t,e){var r;if(typeof e!="function")throw new Mt(b);return t=N(t),function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=i),r}}var os=U(function(t,e,r){var s=qt;if(r.length){var a=Be(r,un(os));s|=oe}return fe(t,s,e,r,a)}),ta=U(function(t,e,r){var s=qt|Ke;if(r.length){var a=Be(r,un(ta));s|=oe}return fe(e,s,t,r,a)});function ea(t,e,r){e=r?i:e;var s=fe(t,se,i,i,i,i,i,e);return s.placeholder=ea.placeholder,s}function na(t,e,r){e=r?i:e;var s=fe(t,fn,i,i,i,i,i,e);return s.placeholder=na.placeholder,s}function ra(t,e,r){var s,a,c,h,d,g,w=0,x=!1,S=!1,B=!0;if(typeof t!="function")throw new Mt(b);e=Ut(e)||0,et(r)&&(x=!!r.leading,S="maxWait"in r,c=S?ut(Ut(r.maxWait)||0,e):c,B="trailing"in r?!!r.trailing:B);function C(it){var Vt=s,ve=a;return s=a=i,w=it,h=t.apply(ve,Vt),h}function R(it){return w=it,d=Mn(H,e),x?C(it):h}function W(it){var Vt=it-g,ve=it-w,ba=e-Vt;return S?gt(ba,c-ve):ba}function I(it){var Vt=it-g,ve=it-w;return g===i||Vt>=e||Vt<0||S&&ve>=c}function H(){var it=Rr();if(I(it))return q(it);d=Mn(H,W(it))}function q(it){return d=i,B&&s?C(it):(s=a=i,h)}function Rt(){d!==i&&du(d),w=0,s=g=a=d=i}function yt(){return d===i?h:q(Rr())}function It(){var it=Rr(),Vt=I(it);if(s=arguments,a=this,g=it,Vt){if(d===i)return R(g);if(S)return du(d),d=Mn(H,e),C(g)}return d===i&&(d=Mn(H,e)),h}return It.cancel=Rt,It.flush=yt,It}var Cp=U(function(t,e){return Yo(t,1,e)}),Ep=U(function(t,e,r){return Yo(t,Ut(e)||0,r)});function Pp(t){return fe(t,Zr)}function Ir(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new Mt(b);var r=function(){var s=arguments,a=e?e.apply(this,s):s[0],c=r.cache;if(c.has(a))return c.get(a);var h=t.apply(this,s);return r.cache=c.set(a,h)||c,h};return r.cache=new(Ir.Cache||ce),r}Ir.Cache=ce;function Lr(t){if(typeof t!="function")throw new Mt(b);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function Op(t){return ju(2,t)}var Rp=vf(function(t,e){e=e.length==1&&M(e[0])?j(e[0],Et(O())):j(dt(e,1),Et(O()));var r=e.length;return U(function(s){for(var a=-1,c=gt(s.length,r);++a<c;)s[a]=e[a].call(this,s[a]);return Ct(t,this,s)})}),us=U(function(t,e){var r=Be(e,un(us));return fe(t,oe,i,e,r)}),ia=U(function(t,e){var r=Be(e,un(ia));return fe(t,dn,i,e,r)}),Ip=de(function(t,e){return fe(t,pn,i,i,i,e)});function Lp(t,e){if(typeof t!="function")throw new Mt(b);return e=e===i?e:N(e),U(t,e)}function kp(t,e){if(typeof t!="function")throw new Mt(b);return e=e==null?0:ut(N(e),0),U(function(r){var s=r[e],a=Pe(r,0,e);return s&&Se(a,s),Ct(t,this,a)})}function Mp(t,e,r){var s=!0,a=!0;if(typeof t!="function")throw new Mt(b);return et(r)&&(s="leading"in r?!!r.leading:s,a="trailing"in r?!!r.trailing:a),ra(t,e,{leading:s,maxWait:e,trailing:a})}function Np(t){return Qu(t,1)}function Dp(t,e){return us(Ki(e),t)}function Wp(){if(!arguments.length)return[];var t=arguments[0];return M(t)?t:[t]}function Fp(t){return Dt(t,we)}function Up(t,e){return e=typeof e=="function"?e:i,Dt(t,we,e)}function Hp(t){return Dt(t,F|we)}function Gp(t,e){return e=typeof e=="function"?e:i,Dt(t,F|we,e)}function qp(t,e){return e==null||Ko(t,e,at(e))}function zt(t,e){return t===e||t!==t&&e!==e}var $p=Tr(Li),Kp=Tr(function(t,e){return t>=e}),qe=Zo(function(){return arguments}())?Zo:function(t){return nt(t)&&X.call(t,"callee")&&!Do.call(t,"callee")},M=v.isArray,Yp=mo?Et(mo):jh;function Bt(t){return t!=null&&kr(t.length)&&!ge(t)}function rt(t){return nt(t)&&Bt(t)}function Xp(t){return t===!0||t===!1||nt(t)&&vt(t)==gn}var Oe=oh||ms,zp=yo?Et(yo):tf;function Vp(t){return nt(t)&&t.nodeType===1&&!Nn(t)}function Jp(t){if(t==null)return!0;if(Bt(t)&&(M(t)||typeof t=="string"||typeof t.splice=="function"||Oe(t)||an(t)||qe(t)))return!t.length;var e=_t(t);if(e==$t||e==Kt)return!t.size;if(kn(t))return!Ni(t).length;for(var r in t)if(X.call(t,r))return!1;return!0}function Zp(t,e){return Rn(t,e)}function Qp(t,e,r){r=typeof r=="function"?r:i;var s=r?r(t,e):i;return s===i?Rn(t,e,i,r):!!s}function as(t){if(!nt(t))return!1;var e=vt(t);return e==Yn||e==wl||typeof t.message=="string"&&typeof t.name=="string"&&!Nn(t)}function jp(t){return typeof t=="number"&&Fo(t)}function ge(t){if(!et(t))return!1;var e=vt(t);return e==Xn||e==Ks||e==yl||e==bl}function sa(t){return typeof t=="number"&&t==N(t)}function kr(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Ye}function et(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function nt(t){return t!=null&&typeof t=="object"}var oa=wo?Et(wo):nf;function tg(t,e){return t===e||Mi(t,e,Qi(e))}function eg(t,e,r){return r=typeof r=="function"?r:i,Mi(t,e,Qi(e),r)}function ng(t){return ua(t)&&t!=+t}function rg(t){if(Uf(t))throw new k(_);return Qo(t)}function ig(t){return t===null}function sg(t){return t==null}function ua(t){return typeof t=="number"||nt(t)&&vt(t)==vn}function Nn(t){if(!nt(t)||vt(t)!=ae)return!1;var e=ur(t);if(e===null)return!0;var r=X.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&rr.call(r)==th}var ls=xo?Et(xo):rf;function og(t){return sa(t)&&t>=-9007199254740991&&t<=Ye}var aa=bo?Et(bo):sf;function Mr(t){return typeof t=="string"||!M(t)&&nt(t)&&vt(t)==yn}function Ot(t){return typeof t=="symbol"||nt(t)&&vt(t)==zn}var an=So?Et(So):of;function ug(t){return t===i}function ag(t){return nt(t)&&_t(t)==wn}function lg(t){return nt(t)&&vt(t)==Bl}var cg=Tr(Di),hg=Tr(function(t,e){return t<=e});function la(t){if(!t)return[];if(Bt(t))return Mr(t)?Yt(t):St(t);if(Sn&&t[Sn])return Gc(t[Sn]());var e=_t(t),r=e==$t?Bi:e==Kt?tr:ln;return r(t)}function _e(t){if(!t)return t===0?t:0;if(t=Ut(t),t===qn||t===-1/0){var e=t<0?-1:1;return e*gl}return t===t?t:0}function N(t){var e=_e(t),r=e%1;return e===e?r?e-r:e:0}function ca(t){return t?Fe(N(t),0,Qt):0}function Ut(t){if(typeof t=="number")return t;if(Ot(t))return $n;if(et(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=et(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Po(t);var r=Kl.test(t);return r||Xl.test(t)?Tc(t.slice(2),r?2:8):$l.test(t)?$n:+t}function ha(t){return te(t,Tt(t))}function fg(t){return t?Fe(N(t),-9007199254740991,Ye):t===0?t:0}function Y(t){return t==null?"":Pt(t)}var dg=sn(function(t,e){if(kn(e)||Bt(e)){te(e,at(e),t);return}for(var r in e)X.call(e,r)&&En(t,r,e[r])}),fa=sn(function(t,e){te(e,Tt(e),t)}),Nr=sn(function(t,e,r,s){te(e,Tt(e),t,s)}),pg=sn(function(t,e,r,s){te(e,at(e),t,s)}),gg=de(Oi);function _g(t,e){var r=rn(t);return e==null?r:$o(r,e)}var vg=U(function(t,e){t=J(t);var r=-1,s=e.length,a=s>2?e[2]:i;for(a&&mt(e[0],e[1],a)&&(s=1);++r<s;)for(var c=e[r],h=Tt(c),d=-1,g=h.length;++d<g;){var w=h[d],x=t[w];(x===i||zt(x,tn[w])&&!X.call(t,w))&&(t[w]=c[w])}return t}),mg=U(function(t){return t.push(i,Pu),Ct(da,i,t)});function yg(t,e){return To(t,O(e,3),jt)}function wg(t,e){return To(t,O(e,3),Ii)}function xg(t,e){return t==null?t:Ri(t,O(e,3),Tt)}function bg(t,e){return t==null?t:Vo(t,O(e,3),Tt)}function Sg(t,e){return t&&jt(t,O(e,3))}function Bg(t,e){return t&&Ii(t,O(e,3))}function Tg(t){return t==null?[]:vr(t,at(t))}function Ag(t){return t==null?[]:vr(t,Tt(t))}function cs(t,e,r){var s=t==null?i:Ue(t,e);return s===i?r:s}function Cg(t,e){return t!=null&&Iu(t,e,Vh)}function hs(t,e){return t!=null&&Iu(t,e,Jh)}var Eg=Bu(function(t,e,r){e!=null&&typeof e.toString!="function"&&(e=ir.call(e)),t[e]=r},ds(At)),Pg=Bu(function(t,e,r){e!=null&&typeof e.toString!="function"&&(e=ir.call(e)),X.call(t,e)?t[e].push(r):t[e]=[r]},O),Og=U(On);function at(t){return Bt(t)?Go(t):Ni(t)}function Tt(t){return Bt(t)?Go(t,!0):uf(t)}function Rg(t,e){var r={};return e=O(e,3),jt(t,function(s,a,c){he(r,e(s,a,c),s)}),r}function Ig(t,e){var r={};return e=O(e,3),jt(t,function(s,a,c){he(r,a,e(s,a,c))}),r}var Lg=sn(function(t,e,r){mr(t,e,r)}),da=sn(function(t,e,r,s){mr(t,e,r,s)}),kg=de(function(t,e){var r={};if(t==null)return r;var s=!1;e=j(e,function(c){return c=Ee(c,t),s||(s=c.length>1),c}),te(t,Ji(t),r),s&&(r=Dt(r,F|Zt|we,Ef));for(var a=e.length;a--;)Gi(r,e[a]);return r});function Mg(t,e){return pa(t,Lr(O(e)))}var Ng=de(function(t,e){return t==null?{}:lf(t,e)});function pa(t,e){if(t==null)return{};var r=j(Ji(t),function(s){return[s]});return e=O(e),su(t,r,function(s,a){return e(s,a[0])})}function Dg(t,e,r){e=Ee(e,t);var s=-1,a=e.length;for(a||(a=1,t=i);++s<a;){var c=t==null?i:t[ee(e[s])];c===i&&(s=a,c=r),t=ge(c)?c.call(t):c}return t}function Wg(t,e,r){return t==null?t:In(t,e,r)}function Fg(t,e,r,s){return s=typeof s=="function"?s:i,t==null?t:In(t,e,r,s)}var ga=Cu(at),_a=Cu(Tt);function Ug(t,e,r){var s=M(t),a=s||Oe(t)||an(t);if(e=O(e,4),r==null){var c=t&&t.constructor;a?r=s?new c:[]:et(t)?r=ge(c)?rn(ur(t)):{}:r={}}return(a?kt:jt)(t,function(h,d,g){return e(r,h,d,g)}),r}function Hg(t,e){return t==null?!0:Gi(t,e)}function Gg(t,e,r){return t==null?t:cu(t,e,Ki(r))}function qg(t,e,r,s){return s=typeof s=="function"?s:i,t==null?t:cu(t,e,Ki(r),s)}function ln(t){return t==null?[]:Si(t,at(t))}function $g(t){return t==null?[]:Si(t,Tt(t))}function Kg(t,e,r){return r===i&&(r=e,e=i),r!==i&&(r=Ut(r),r=r===r?r:0),e!==i&&(e=Ut(e),e=e===e?e:0),Fe(Ut(t),e,r)}function Yg(t,e,r){return e=_e(e),r===i?(r=e,e=0):r=_e(r),t=Ut(t),Zh(t,e,r)}function Xg(t,e,r){if(r&&typeof r!="boolean"&&mt(t,e,r)&&(e=r=i),r===i&&(typeof e=="boolean"?(r=e,e=i):typeof t=="boolean"&&(r=t,t=i)),t===i&&e===i?(t=0,e=1):(t=_e(t),e===i?(e=t,t=0):e=_e(e)),t>e){var s=t;t=e,e=s}if(r||t%1||e%1){var a=Uo();return gt(t+a*(e-t+Bc("1e-"+((a+"").length-1))),e)}return Fi(t,e)}var zg=on(function(t,e,r){return e=e.toLowerCase(),t+(r?va(e):e)});function va(t){return fs(Y(t).toLowerCase())}function ma(t){return t=Y(t),t&&t.replace(Vl,Dc).replace(pc,"")}function Vg(t,e,r){t=Y(t),e=Pt(e);var s=t.length;r=r===i?s:Fe(N(r),0,s);var a=r;return r-=e.length,r>=0&&t.slice(r,a)==e}function Jg(t){return t=Y(t),t&&Pl.test(t)?t.replace(zs,Wc):t}function Zg(t){return t=Y(t),t&&Ml.test(t)?t.replace(ui,"\\$&"):t}var Qg=on(function(t,e,r){return t+(r?"-":"")+e.toLowerCase()}),jg=on(function(t,e,r){return t+(r?" ":"")+e.toLowerCase()}),t_=xu("toLowerCase");function e_(t,e,r){t=Y(t),e=N(e);var s=e?Qe(t):0;if(!e||s>=e)return t;var a=(e-s)/2;return Br(hr(a),r)+t+Br(cr(a),r)}function n_(t,e,r){t=Y(t),e=N(e);var s=e?Qe(t):0;return e&&s<e?t+Br(e-s,r):t}function r_(t,e,r){t=Y(t),e=N(e);var s=e?Qe(t):0;return e&&s<e?Br(e-s,r)+t:t}function i_(t,e,r){return r||e==null?e=0:e&&(e=+e),ch(Y(t).replace(ai,""),e||0)}function s_(t,e,r){return(r?mt(t,e,r):e===i)?e=1:e=N(e),Ui(Y(t),e)}function o_(){var t=arguments,e=Y(t[0]);return t.length<3?e:e.replace(t[1],t[2])}var u_=on(function(t,e,r){return t+(r?"_":"")+e.toLowerCase()});function a_(t,e,r){return r&&typeof r!="number"&&mt(t,e,r)&&(e=r=i),r=r===i?Qt:r>>>0,r?(t=Y(t),t&&(typeof e=="string"||e!=null&&!ls(e))&&(e=Pt(e),!e&&Ze(t))?Pe(Yt(t),0,r):t.split(e,r)):[]}var l_=on(function(t,e,r){return t+(r?" ":"")+fs(e)});function c_(t,e,r){return t=Y(t),r=r==null?0:Fe(N(r),0,t.length),e=Pt(e),t.slice(r,r+e.length)==e}function h_(t,e,r){var s=l.templateSettings;r&&mt(t,e,r)&&(e=i),t=Y(t),e=Nr({},e,s,Eu);var a=Nr({},e.imports,s.imports,Eu),c=at(a),h=Si(a,c),d,g,w=0,x=e.interpolate||Vn,S="__p += '",B=Ti((e.escape||Vn).source+"|"+x.source+"|"+(x===Vs?ql:Vn).source+"|"+(e.evaluate||Vn).source+"|$","g"),C="//# sourceURL="+(X.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++yc+"]")+`
`;t.replace(B,function(I,H,q,Rt,yt,It){return q||(q=Rt),S+=t.slice(w,It).replace(Jl,Fc),H&&(d=!0,S+=`' +
__e(`+H+`) +
'`),yt&&(g=!0,S+=`';
`+yt+`;
__p += '`),q&&(S+=`' +
((__t = (`+q+`)) == null ? '' : __t) +
'`),w=It+I.length,I}),S+=`';
`;var R=X.call(e,"variable")&&e.variable;if(!R)S=`with (obj) {
`+S+`
}
`;else if(Hl.test(R))throw new k(P);S=(g?S.replace(Tl,""):S).replace(Al,"$1").replace(Cl,"$1;"),S="function("+(R||"obj")+`) {
`+(R?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(d?", __e = _.escape":"")+(g?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+S+`return __p
}`;var W=wa(function(){return K(c,C+"return "+S).apply(i,h)});if(W.source=S,as(W))throw W;return W}function f_(t){return Y(t).toLowerCase()}function d_(t){return Y(t).toUpperCase()}function p_(t,e,r){if(t=Y(t),t&&(r||e===i))return Po(t);if(!t||!(e=Pt(e)))return t;var s=Yt(t),a=Yt(e),c=Oo(s,a),h=Ro(s,a)+1;return Pe(s,c,h).join("")}function g_(t,e,r){if(t=Y(t),t&&(r||e===i))return t.slice(0,Lo(t)+1);if(!t||!(e=Pt(e)))return t;var s=Yt(t),a=Ro(s,Yt(e))+1;return Pe(s,0,a).join("")}function __(t,e,r){if(t=Y(t),t&&(r||e===i))return t.replace(ai,"");if(!t||!(e=Pt(e)))return t;var s=Yt(t),a=Oo(s,Yt(e));return Pe(s,a).join("")}function v_(t,e){var r=ll,s=cl;if(et(e)){var a="separator"in e?e.separator:a;r="length"in e?N(e.length):r,s="omission"in e?Pt(e.omission):s}t=Y(t);var c=t.length;if(Ze(t)){var h=Yt(t);c=h.length}if(r>=c)return t;var d=r-Qe(s);if(d<1)return s;var g=h?Pe(h,0,d).join(""):t.slice(0,d);if(a===i)return g+s;if(h&&(d+=g.length-d),ls(a)){if(t.slice(d).search(a)){var w,x=g;for(a.global||(a=Ti(a.source,Y(Js.exec(a))+"g")),a.lastIndex=0;w=a.exec(x);)var S=w.index;g=g.slice(0,S===i?d:S)}}else if(t.indexOf(Pt(a),d)!=d){var B=g.lastIndexOf(a);B>-1&&(g=g.slice(0,B))}return g+s}function m_(t){return t=Y(t),t&&El.test(t)?t.replace(Xs,Yc):t}var y_=on(function(t,e,r){return t+(r?" ":"")+e.toUpperCase()}),fs=xu("toUpperCase");function ya(t,e,r){return t=Y(t),e=r?i:e,e===i?Hc(t)?Vc(t):Ic(t):t.match(e)||[]}var wa=U(function(t,e){try{return Ct(t,i,e)}catch(r){return as(r)?r:new k(r)}}),w_=de(function(t,e){return kt(e,function(r){r=ee(r),he(t,r,os(t[r],t))}),t});function x_(t){var e=t==null?0:t.length,r=O();return t=e?j(t,function(s){if(typeof s[1]!="function")throw new Mt(b);return[r(s[0]),s[1]]}):[],U(function(s){for(var a=-1;++a<e;){var c=t[a];if(Ct(c[0],this,s))return Ct(c[1],this,s)}})}function b_(t){return Yh(Dt(t,F))}function ds(t){return function(){return t}}function S_(t,e){return t==null||t!==t?e:t}var B_=Su(),T_=Su(!0);function At(t){return t}function ps(t){return jo(typeof t=="function"?t:Dt(t,F))}function A_(t){return eu(Dt(t,F))}function C_(t,e){return nu(t,Dt(e,F))}var E_=U(function(t,e){return function(r){return On(r,t,e)}}),P_=U(function(t,e){return function(r){return On(t,r,e)}});function gs(t,e,r){var s=at(e),a=vr(e,s);r==null&&!(et(e)&&(a.length||!s.length))&&(r=e,e=t,t=this,a=vr(e,at(e)));var c=!(et(r)&&"chain"in r)||!!r.chain,h=ge(t);return kt(a,function(d){var g=e[d];t[d]=g,h&&(t.prototype[d]=function(){var w=this.__chain__;if(c||w){var x=t(this.__wrapped__),S=x.__actions__=St(this.__actions__);return S.push({func:g,args:arguments,thisArg:t}),x.__chain__=w,x}return g.apply(t,Se([this.value()],arguments))})}),t}function O_(){return ft._===this&&(ft._=eh),this}function _s(){}function R_(t){return t=N(t),U(function(e){return ru(e,t)})}var I_=Xi(j),L_=Xi(Bo),k_=Xi(mi);function xa(t){return ts(t)?yi(ee(t)):cf(t)}function M_(t){return function(e){return t==null?i:Ue(t,e)}}var N_=Tu(),D_=Tu(!0);function vs(){return[]}function ms(){return!1}function W_(){return{}}function F_(){return""}function U_(){return!0}function H_(t,e){if(t=N(t),t<1||t>Ye)return[];var r=Qt,s=gt(t,Qt);e=O(e),t-=Qt;for(var a=bi(s,e);++r<t;)e(r);return a}function G_(t){return M(t)?j(t,ee):Ot(t)?[t]:St(Hu(Y(t)))}function q_(t){var e=++jc;return Y(t)+e}var $_=Sr(function(t,e){return t+e},0),K_=zi("ceil"),Y_=Sr(function(t,e){return t/e},1),X_=zi("floor");function z_(t){return t&&t.length?_r(t,At,Li):i}function V_(t,e){return t&&t.length?_r(t,O(e,2),Li):i}function J_(t){return Co(t,At)}function Z_(t,e){return Co(t,O(e,2))}function Q_(t){return t&&t.length?_r(t,At,Di):i}function j_(t,e){return t&&t.length?_r(t,O(e,2),Di):i}var tv=Sr(function(t,e){return t*e},1),ev=zi("round"),nv=Sr(function(t,e){return t-e},0);function rv(t){return t&&t.length?xi(t,At):0}function iv(t,e){return t&&t.length?xi(t,O(e,2)):0}return l.after=Ap,l.ary=Qu,l.assign=dg,l.assignIn=fa,l.assignInWith=Nr,l.assignWith=pg,l.at=gg,l.before=ju,l.bind=os,l.bindAll=w_,l.bindKey=ta,l.castArray=Wp,l.chain=Vu,l.chunk=Xf,l.compact=zf,l.concat=Vf,l.cond=x_,l.conforms=b_,l.constant=ds,l.countBy=rp,l.create=_g,l.curry=ea,l.curryRight=na,l.debounce=ra,l.defaults=vg,l.defaultsDeep=mg,l.defer=Cp,l.delay=Ep,l.difference=Jf,l.differenceBy=Zf,l.differenceWith=Qf,l.drop=jf,l.dropRight=td,l.dropRightWhile=ed,l.dropWhile=nd,l.fill=rd,l.filter=sp,l.flatMap=ap,l.flatMapDeep=lp,l.flatMapDepth=cp,l.flatten=Ku,l.flattenDeep=id,l.flattenDepth=sd,l.flip=Pp,l.flow=B_,l.flowRight=T_,l.fromPairs=od,l.functions=Tg,l.functionsIn=Ag,l.groupBy=hp,l.initial=ad,l.intersection=ld,l.intersectionBy=cd,l.intersectionWith=hd,l.invert=Eg,l.invertBy=Pg,l.invokeMap=dp,l.iteratee=ps,l.keyBy=pp,l.keys=at,l.keysIn=Tt,l.map=Or,l.mapKeys=Rg,l.mapValues=Ig,l.matches=A_,l.matchesProperty=C_,l.memoize=Ir,l.merge=Lg,l.mergeWith=da,l.method=E_,l.methodOf=P_,l.mixin=gs,l.negate=Lr,l.nthArg=R_,l.omit=kg,l.omitBy=Mg,l.once=Op,l.orderBy=gp,l.over=I_,l.overArgs=Rp,l.overEvery=L_,l.overSome=k_,l.partial=us,l.partialRight=ia,l.partition=_p,l.pick=Ng,l.pickBy=pa,l.property=xa,l.propertyOf=M_,l.pull=gd,l.pullAll=Xu,l.pullAllBy=_d,l.pullAllWith=vd,l.pullAt=md,l.range=N_,l.rangeRight=D_,l.rearg=Ip,l.reject=yp,l.remove=yd,l.rest=Lp,l.reverse=is,l.sampleSize=xp,l.set=Wg,l.setWith=Fg,l.shuffle=bp,l.slice=wd,l.sortBy=Tp,l.sortedUniq=Cd,l.sortedUniqBy=Ed,l.split=a_,l.spread=kp,l.tail=Pd,l.take=Od,l.takeRight=Rd,l.takeRightWhile=Id,l.takeWhile=Ld,l.tap=zd,l.throttle=Mp,l.thru=Pr,l.toArray=la,l.toPairs=ga,l.toPairsIn=_a,l.toPath=G_,l.toPlainObject=ha,l.transform=Ug,l.unary=Np,l.union=kd,l.unionBy=Md,l.unionWith=Nd,l.uniq=Dd,l.uniqBy=Wd,l.uniqWith=Fd,l.unset=Hg,l.unzip=ss,l.unzipWith=zu,l.update=Gg,l.updateWith=qg,l.values=ln,l.valuesIn=$g,l.without=Ud,l.words=ya,l.wrap=Dp,l.xor=Hd,l.xorBy=Gd,l.xorWith=qd,l.zip=$d,l.zipObject=Kd,l.zipObjectDeep=Yd,l.zipWith=Xd,l.entries=ga,l.entriesIn=_a,l.extend=fa,l.extendWith=Nr,gs(l,l),l.add=$_,l.attempt=wa,l.camelCase=zg,l.capitalize=va,l.ceil=K_,l.clamp=Kg,l.clone=Fp,l.cloneDeep=Hp,l.cloneDeepWith=Gp,l.cloneWith=Up,l.conformsTo=qp,l.deburr=ma,l.defaultTo=S_,l.divide=Y_,l.endsWith=Vg,l.eq=zt,l.escape=Jg,l.escapeRegExp=Zg,l.every=ip,l.find=op,l.findIndex=qu,l.findKey=yg,l.findLast=up,l.findLastIndex=$u,l.findLastKey=wg,l.floor=X_,l.forEach=Ju,l.forEachRight=Zu,l.forIn=xg,l.forInRight=bg,l.forOwn=Sg,l.forOwnRight=Bg,l.get=cs,l.gt=$p,l.gte=Kp,l.has=Cg,l.hasIn=hs,l.head=Yu,l.identity=At,l.includes=fp,l.indexOf=ud,l.inRange=Yg,l.invoke=Og,l.isArguments=qe,l.isArray=M,l.isArrayBuffer=Yp,l.isArrayLike=Bt,l.isArrayLikeObject=rt,l.isBoolean=Xp,l.isBuffer=Oe,l.isDate=zp,l.isElement=Vp,l.isEmpty=Jp,l.isEqual=Zp,l.isEqualWith=Qp,l.isError=as,l.isFinite=jp,l.isFunction=ge,l.isInteger=sa,l.isLength=kr,l.isMap=oa,l.isMatch=tg,l.isMatchWith=eg,l.isNaN=ng,l.isNative=rg,l.isNil=sg,l.isNull=ig,l.isNumber=ua,l.isObject=et,l.isObjectLike=nt,l.isPlainObject=Nn,l.isRegExp=ls,l.isSafeInteger=og,l.isSet=aa,l.isString=Mr,l.isSymbol=Ot,l.isTypedArray=an,l.isUndefined=ug,l.isWeakMap=ag,l.isWeakSet=lg,l.join=fd,l.kebabCase=Qg,l.last=Ft,l.lastIndexOf=dd,l.lowerCase=jg,l.lowerFirst=t_,l.lt=cg,l.lte=hg,l.max=z_,l.maxBy=V_,l.mean=J_,l.meanBy=Z_,l.min=Q_,l.minBy=j_,l.stubArray=vs,l.stubFalse=ms,l.stubObject=W_,l.stubString=F_,l.stubTrue=U_,l.multiply=tv,l.nth=pd,l.noConflict=O_,l.noop=_s,l.now=Rr,l.pad=e_,l.padEnd=n_,l.padStart=r_,l.parseInt=i_,l.random=Xg,l.reduce=vp,l.reduceRight=mp,l.repeat=s_,l.replace=o_,l.result=Dg,l.round=ev,l.runInContext=p,l.sample=wp,l.size=Sp,l.snakeCase=u_,l.some=Bp,l.sortedIndex=xd,l.sortedIndexBy=bd,l.sortedIndexOf=Sd,l.sortedLastIndex=Bd,l.sortedLastIndexBy=Td,l.sortedLastIndexOf=Ad,l.startCase=l_,l.startsWith=c_,l.subtract=nv,l.sum=rv,l.sumBy=iv,l.template=h_,l.times=H_,l.toFinite=_e,l.toInteger=N,l.toLength=ca,l.toLower=f_,l.toNumber=Ut,l.toSafeInteger=fg,l.toString=Y,l.toUpper=d_,l.trim=p_,l.trimEnd=g_,l.trimStart=__,l.truncate=v_,l.unescape=m_,l.uniqueId=q_,l.upperCase=y_,l.upperFirst=fs,l.each=Ju,l.eachRight=Zu,l.first=Yu,gs(l,function(){var t={};return jt(l,function(e,r){X.call(l.prototype,r)||(t[r]=e)}),t}(),{chain:!1}),l.VERSION=o,kt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){l[t].placeholder=l}),kt(["drop","take"],function(t,e){G.prototype[t]=function(r){r=r===i?1:ut(N(r),0);var s=this.__filtered__&&!e?new G(this):this.clone();return s.__filtered__?s.__takeCount__=gt(r,s.__takeCount__):s.__views__.push({size:gt(r,Qt),type:t+(s.__dir__<0?"Right":"")}),s},G.prototype[t+"Right"]=function(r){return this.reverse()[t](r).reverse()}}),kt(["filter","map","takeWhile"],function(t,e){var r=e+1,s=r==$s||r==pl;G.prototype[t]=function(a){var c=this.clone();return c.__iteratees__.push({iteratee:O(a,3),type:r}),c.__filtered__=c.__filtered__||s,c}}),kt(["head","last"],function(t,e){var r="take"+(e?"Right":"");G.prototype[t]=function(){return this[r](1).value()[0]}}),kt(["initial","tail"],function(t,e){var r="drop"+(e?"":"Right");G.prototype[t]=function(){return this.__filtered__?new G(this):this[r](1)}}),G.prototype.compact=function(){return this.filter(At)},G.prototype.find=function(t){return this.filter(t).head()},G.prototype.findLast=function(t){return this.reverse().find(t)},G.prototype.invokeMap=U(function(t,e){return typeof t=="function"?new G(this):this.map(function(r){return On(r,t,e)})}),G.prototype.reject=function(t){return this.filter(Lr(O(t)))},G.prototype.slice=function(t,e){t=N(t);var r=this;return r.__filtered__&&(t>0||e<0)?new G(r):(t<0?r=r.takeRight(-t):t&&(r=r.drop(t)),e!==i&&(e=N(e),r=e<0?r.dropRight(-e):r.take(e-t)),r)},G.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},G.prototype.toArray=function(){return this.take(Qt)},jt(G.prototype,function(t,e){var r=/^(?:filter|find|map|reject)|While$/.test(e),s=/^(?:head|last)$/.test(e),a=l[s?"take"+(e=="last"?"Right":""):e],c=s||/^find/.test(e);a&&(l.prototype[e]=function(){var h=this.__wrapped__,d=s?[1]:arguments,g=h instanceof G,w=d[0],x=g||M(h),S=function(H){var q=a.apply(l,Se([H],d));return s&&B?q[0]:q};x&&r&&typeof w=="function"&&w.length!=1&&(g=x=!1);var B=this.__chain__,C=!!this.__actions__.length,R=c&&!B,W=g&&!C;if(!c&&x){h=W?h:new G(this);var I=t.apply(h,d);return I.__actions__.push({func:Pr,args:[S],thisArg:i}),new Nt(I,B)}return R&&W?t.apply(this,d):(I=this.thru(S),R?s?I.value()[0]:I.value():I)})}),kt(["pop","push","shift","sort","splice","unshift"],function(t){var e=er[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",s=/^(?:pop|shift)$/.test(t);l.prototype[t]=function(){var a=arguments;if(s&&!this.__chain__){var c=this.value();return e.apply(M(c)?c:[],a)}return this[r](function(h){return e.apply(M(h)?h:[],a)})}}),jt(G.prototype,function(t,e){var r=l[e];if(r){var s=r.name+"";X.call(nn,s)||(nn[s]=[]),nn[s].push({name:e,func:r})}}),nn[br(i,Ke).name]=[{name:"wrapper",func:i}],G.prototype.clone=vh,G.prototype.reverse=mh,G.prototype.value=yh,l.prototype.at=Vd,l.prototype.chain=Jd,l.prototype.commit=Zd,l.prototype.next=Qd,l.prototype.plant=tp,l.prototype.reverse=ep,l.prototype.toJSON=l.prototype.valueOf=l.prototype.value=np,l.prototype.first=l.prototype.head,Sn&&(l.prototype[Sn]=jd),l},je=Jc();Me?((Me.exports=je)._=je,pi._=je):ft._=je}).call(lv)}(Fn,Fn.exports)),Fn.exports}var hv=cv();const fv=av(hv);class qa{constructor(){A(this,"down",!1);A(this,"pressed",!1)}}const ie=Object.create(null);ie.open="0";ie.close="1";ie.ping="2";ie.pong="3";ie.message="4";ie.upgrade="5";ie.noop="6";const Gr=Object.create(null);Object.keys(ie).forEach(u=>{Gr[ie[u]]=u});const Cs={type:"error",data:"parser error"},$a=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Ka=typeof ArrayBuffer=="function",Ya=u=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(u):u&&u.buffer instanceof ArrayBuffer,ks=({type:u,data:n},i,o)=>$a&&n instanceof Blob?i?o(n):Ba(n,o):Ka&&(n instanceof ArrayBuffer||Ya(n))?i?o(n):Ba(new Blob([n]),o):o(ie[u]+(n||"")),Ba=(u,n)=>{const i=new FileReader;return i.onload=function(){const o=i.result.split(",")[1];n("b"+(o||""))},i.readAsDataURL(u)};function Ta(u){return u instanceof Uint8Array?u:u instanceof ArrayBuffer?new Uint8Array(u):new Uint8Array(u.buffer,u.byteOffset,u.byteLength)}let ws;function dv(u,n){if($a&&u.data instanceof Blob)return u.data.arrayBuffer().then(Ta).then(n);if(Ka&&(u.data instanceof ArrayBuffer||Ya(u.data)))return n(Ta(u.data));ks(u,!1,i=>{ws||(ws=new TextEncoder),n(ws.encode(i))})}const Aa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Un=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let u=0;u<Aa.length;u++)Un[Aa.charCodeAt(u)]=u;const pv=u=>{let n=u.length*.75,i=u.length,o,f=0,_,b,P,L;u[u.length-1]==="="&&(n--,u[u.length-2]==="="&&n--);const ht=new ArrayBuffer(n),tt=new Uint8Array(ht);for(o=0;o<i;o+=4)_=Un[u.charCodeAt(o)],b=Un[u.charCodeAt(o+1)],P=Un[u.charCodeAt(o+2)],L=Un[u.charCodeAt(o+3)],tt[f++]=_<<2|b>>4,tt[f++]=(b&15)<<4|P>>2,tt[f++]=(P&3)<<6|L&63;return ht},gv=typeof ArrayBuffer=="function",Ms=(u,n)=>{if(typeof u!="string")return{type:"message",data:Xa(u,n)};const i=u.charAt(0);return i==="b"?{type:"message",data:_v(u.substring(1),n)}:Gr[i]?u.length>1?{type:Gr[i],data:u.substring(1)}:{type:Gr[i]}:Cs},_v=(u,n)=>{if(gv){const i=pv(u);return Xa(i,n)}else return{base64:!0,data:u}},Xa=(u,n)=>{switch(n){case"blob":return u instanceof Blob?u:new Blob([u]);case"arraybuffer":default:return u instanceof ArrayBuffer?u:u.buffer}},za="",vv=(u,n)=>{const i=u.length,o=new Array(i);let f=0;u.forEach((_,b)=>{ks(_,!1,P=>{o[b]=P,++f===i&&n(o.join(za))})})},mv=(u,n)=>{const i=u.split(za),o=[];for(let f=0;f<i.length;f++){const _=Ms(i[f],n);if(o.push(_),_.type==="error")break}return o};function yv(){return new TransformStream({transform(u,n){dv(u,i=>{const o=i.length;let f;if(o<126)f=new Uint8Array(1),new DataView(f.buffer).setUint8(0,o);else if(o<65536){f=new Uint8Array(3);const _=new DataView(f.buffer);_.setUint8(0,126),_.setUint16(1,o)}else{f=new Uint8Array(9);const _=new DataView(f.buffer);_.setUint8(0,127),_.setBigUint64(1,BigInt(o))}u.data&&typeof u.data!="string"&&(f[0]|=128),n.enqueue(f),n.enqueue(i)})}})}let xs;function Wr(u){return u.reduce((n,i)=>n+i.length,0)}function Fr(u,n){if(u[0].length===n)return u.shift();const i=new Uint8Array(n);let o=0;for(let f=0;f<n;f++)i[f]=u[0][o++],o===u[0].length&&(u.shift(),o=0);return u.length&&o<u[0].length&&(u[0]=u[0].slice(o)),i}function wv(u,n){xs||(xs=new TextDecoder);const i=[];let o=0,f=-1,_=!1;return new TransformStream({transform(b,P){for(i.push(b);;){if(o===0){if(Wr(i)<1)break;const L=Fr(i,1);_=(L[0]&128)===128,f=L[0]&127,f<126?o=3:f===126?o=1:o=2}else if(o===1){if(Wr(i)<2)break;const L=Fr(i,2);f=new DataView(L.buffer,L.byteOffset,L.length).getUint16(0),o=3}else if(o===2){if(Wr(i)<8)break;const L=Fr(i,8),ht=new DataView(L.buffer,L.byteOffset,L.length),tt=ht.getUint32(0);if(tt>Math.pow(2,21)-1){P.enqueue(Cs);break}f=tt*Math.pow(2,32)+ht.getUint32(4),o=3}else{if(Wr(i)<f)break;const L=Fr(i,f);P.enqueue(Ms(_?L:xs.decode(L),n)),o=0}if(f===0||f>u){P.enqueue(Cs);break}}}})}const Va=4;function st(u){if(u)return xv(u)}function xv(u){for(var n in st.prototype)u[n]=st.prototype[n];return u}st.prototype.on=st.prototype.addEventListener=function(u,n){return this._callbacks=this._callbacks||{},(this._callbacks["$"+u]=this._callbacks["$"+u]||[]).push(n),this};st.prototype.once=function(u,n){function i(){this.off(u,i),n.apply(this,arguments)}return i.fn=n,this.on(u,i),this};st.prototype.off=st.prototype.removeListener=st.prototype.removeAllListeners=st.prototype.removeEventListener=function(u,n){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var i=this._callbacks["$"+u];if(!i)return this;if(arguments.length==1)return delete this._callbacks["$"+u],this;for(var o,f=0;f<i.length;f++)if(o=i[f],o===n||o.fn===n){i.splice(f,1);break}return i.length===0&&delete this._callbacks["$"+u],this};st.prototype.emit=function(u){this._callbacks=this._callbacks||{};for(var n=new Array(arguments.length-1),i=this._callbacks["$"+u],o=1;o<arguments.length;o++)n[o-1]=arguments[o];if(i){i=i.slice(0);for(var o=0,f=i.length;o<f;++o)i[o].apply(this,n)}return this};st.prototype.emitReserved=st.prototype.emit;st.prototype.listeners=function(u){return this._callbacks=this._callbacks||{},this._callbacks["$"+u]||[]};st.prototype.hasListeners=function(u){return!!this.listeners(u).length};const Vr=typeof Promise=="function"&&typeof Promise.resolve=="function"?n=>Promise.resolve().then(n):(n,i)=>i(n,0),Gt=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),bv="arraybuffer";function Ja(u,...n){return n.reduce((i,o)=>(u.hasOwnProperty(o)&&(i[o]=u[o]),i),{})}const Sv=Gt.setTimeout,Bv=Gt.clearTimeout;function Jr(u,n){n.useNativeTimers?(u.setTimeoutFn=Sv.bind(Gt),u.clearTimeoutFn=Bv.bind(Gt)):(u.setTimeoutFn=Gt.setTimeout.bind(Gt),u.clearTimeoutFn=Gt.clearTimeout.bind(Gt))}const Tv=1.33;function Av(u){return typeof u=="string"?Cv(u):Math.ceil((u.byteLength||u.size)*Tv)}function Cv(u){let n=0,i=0;for(let o=0,f=u.length;o<f;o++)n=u.charCodeAt(o),n<128?i+=1:n<2048?i+=2:n<55296||n>=57344?i+=3:(o++,i+=4);return i}function Za(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Ev(u){let n="";for(let i in u)u.hasOwnProperty(i)&&(n.length&&(n+="&"),n+=encodeURIComponent(i)+"="+encodeURIComponent(u[i]));return n}function Pv(u){let n={},i=u.split("&");for(let o=0,f=i.length;o<f;o++){let _=i[o].split("=");n[decodeURIComponent(_[0])]=decodeURIComponent(_[1])}return n}class Ov extends Error{constructor(n,i,o){super(n),this.description=i,this.context=o,this.type="TransportError"}}class Ns extends st{constructor(n){super(),this.writable=!1,Jr(this,n),this.opts=n,this.query=n.query,this.socket=n.socket,this.supportsBinary=!n.forceBase64}onError(n,i,o){return super.emitReserved("error",new Ov(n,i,o)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(n){this.readyState==="open"&&this.write(n)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(n){const i=Ms(n,this.socket.binaryType);this.onPacket(i)}onPacket(n){super.emitReserved("packet",n)}onClose(n){this.readyState="closed",super.emitReserved("close",n)}pause(n){}createUri(n,i={}){return n+"://"+this._hostname()+this._port()+this.opts.path+this._query(i)}_hostname(){const n=this.opts.hostname;return n.indexOf(":")===-1?n:"["+n+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(n){const i=Ev(n);return i.length?"?"+i:""}}class Rv extends Ns{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(n){this.readyState="pausing";const i=()=>{this.readyState="paused",n()};if(this._polling||!this.writable){let o=0;this._polling&&(o++,this.once("pollComplete",function(){--o||i()})),this.writable||(o++,this.once("drain",function(){--o||i()}))}else i()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(n){const i=o=>{if(this.readyState==="opening"&&o.type==="open"&&this.onOpen(),o.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(o)};mv(n,this.socket.binaryType).forEach(i),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const n=()=>{this.write([{type:"close"}])};this.readyState==="open"?n():this.once("open",n)}write(n){this.writable=!1,vv(n,i=>{this.doWrite(i,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const n=this.opts.secure?"https":"http",i=this.query||{};return this.opts.timestampRequests!==!1&&(i[this.opts.timestampParam]=Za()),!this.supportsBinary&&!i.sid&&(i.b64=1),this.createUri(n,i)}}let Qa=!1;try{Qa=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Iv=Qa;function Lv(){}class kv extends Rv{constructor(n){if(super(n),typeof location<"u"){const i=location.protocol==="https:";let o=location.port;o||(o=i?"443":"80"),this.xd=typeof location<"u"&&n.hostname!==location.hostname||o!==n.port}}doWrite(n,i){const o=this.request({method:"POST",data:n});o.on("success",i),o.on("error",(f,_)=>{this.onError("xhr post error",f,_)})}doPoll(){const n=this.request();n.on("data",this.onData.bind(this)),n.on("error",(i,o)=>{this.onError("xhr poll error",i,o)}),this.pollXhr=n}}class re extends st{constructor(n,i,o){super(),this.createRequest=n,Jr(this,o),this._opts=o,this._method=o.method||"GET",this._uri=i,this._data=o.data!==void 0?o.data:null,this._create()}_create(){var n;const i=Ja(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");i.xdomain=!!this._opts.xd;const o=this._xhr=this.createRequest(i);try{o.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){o.setDisableHeaderCheck&&o.setDisableHeaderCheck(!0);for(let f in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(f)&&o.setRequestHeader(f,this._opts.extraHeaders[f])}}catch{}if(this._method==="POST")try{o.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{o.setRequestHeader("Accept","*/*")}catch{}(n=this._opts.cookieJar)===null||n===void 0||n.addCookies(o),"withCredentials"in o&&(o.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(o.timeout=this._opts.requestTimeout),o.onreadystatechange=()=>{var f;o.readyState===3&&((f=this._opts.cookieJar)===null||f===void 0||f.parseCookies(o.getResponseHeader("set-cookie"))),o.readyState===4&&(o.status===200||o.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof o.status=="number"?o.status:0)},0))},o.send(this._data)}catch(f){this.setTimeoutFn(()=>{this._onError(f)},0);return}typeof document<"u"&&(this._index=re.requestsCount++,re.requests[this._index]=this)}_onError(n){this.emitReserved("error",n,this._xhr),this._cleanup(!0)}_cleanup(n){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Lv,n)try{this._xhr.abort()}catch{}typeof document<"u"&&delete re.requests[this._index],this._xhr=null}}_onLoad(){const n=this._xhr.responseText;n!==null&&(this.emitReserved("data",n),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}re.requestsCount=0;re.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ca);else if(typeof addEventListener=="function"){const u="onpagehide"in Gt?"pagehide":"unload";addEventListener(u,Ca,!1)}}function Ca(){for(let u in re.requests)re.requests.hasOwnProperty(u)&&re.requests[u].abort()}const Mv=function(){const u=ja({xdomain:!1});return u&&u.responseType!==null}();class Nv extends kv{constructor(n){super(n);const i=n&&n.forceBase64;this.supportsBinary=Mv&&!i}request(n={}){return Object.assign(n,{xd:this.xd},this.opts),new re(ja,this.uri(),n)}}function ja(u){const n=u.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!n||Iv))return new XMLHttpRequest}catch{}if(!n)try{return new Gt[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const tl=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Dv extends Ns{get name(){return"websocket"}doOpen(){const n=this.uri(),i=this.opts.protocols,o=tl?{}:Ja(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(o.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(n,i,o)}catch(f){return this.emitReserved("error",f)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=n=>this.onClose({description:"websocket connection closed",context:n}),this.ws.onmessage=n=>this.onData(n.data),this.ws.onerror=n=>this.onError("websocket error",n)}write(n){this.writable=!1;for(let i=0;i<n.length;i++){const o=n[i],f=i===n.length-1;ks(o,this.supportsBinary,_=>{try{this.doWrite(o,_)}catch{}f&&Vr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const n=this.opts.secure?"wss":"ws",i=this.query||{};return this.opts.timestampRequests&&(i[this.opts.timestampParam]=Za()),this.supportsBinary||(i.b64=1),this.createUri(n,i)}}const bs=Gt.WebSocket||Gt.MozWebSocket;class Wv extends Dv{createSocket(n,i,o){return tl?new bs(n,i,o):i?new bs(n,i):new bs(n)}doWrite(n,i){this.ws.send(i)}}class Fv extends Ns{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(n){return this.emitReserved("error",n)}this._transport.closed.then(()=>{this.onClose()}).catch(n=>{this.onError("webtransport error",n)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(n=>{const i=wv(Number.MAX_SAFE_INTEGER,this.socket.binaryType),o=n.readable.pipeThrough(i).getReader(),f=yv();f.readable.pipeTo(n.writable),this._writer=f.writable.getWriter();const _=()=>{o.read().then(({done:P,value:L})=>{P||(this.onPacket(L),_())}).catch(P=>{})};_();const b={type:"open"};this.query.sid&&(b.data=`{"sid":"${this.query.sid}"}`),this._writer.write(b).then(()=>this.onOpen())})})}write(n){this.writable=!1;for(let i=0;i<n.length;i++){const o=n[i],f=i===n.length-1;this._writer.write(o).then(()=>{f&&Vr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var n;(n=this._transport)===null||n===void 0||n.close()}}const Uv={websocket:Wv,webtransport:Fv,polling:Nv},Hv=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Gv=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Es(u){if(u.length>8e3)throw"URI too long";const n=u,i=u.indexOf("["),o=u.indexOf("]");i!=-1&&o!=-1&&(u=u.substring(0,i)+u.substring(i,o).replace(/:/g,";")+u.substring(o,u.length));let f=Hv.exec(u||""),_={},b=14;for(;b--;)_[Gv[b]]=f[b]||"";return i!=-1&&o!=-1&&(_.source=n,_.host=_.host.substring(1,_.host.length-1).replace(/;/g,":"),_.authority=_.authority.replace("[","").replace("]","").replace(/;/g,":"),_.ipv6uri=!0),_.pathNames=qv(_,_.path),_.queryKey=$v(_,_.query),_}function qv(u,n){const i=/\/{2,9}/g,o=n.replace(i,"/").split("/");return(n.slice(0,1)=="/"||n.length===0)&&o.splice(0,1),n.slice(-1)=="/"&&o.splice(o.length-1,1),o}function $v(u,n){const i={};return n.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(o,f,_){f&&(i[f]=_)}),i}const Ps=typeof addEventListener=="function"&&typeof removeEventListener=="function",qr=[];Ps&&addEventListener("offline",()=>{qr.forEach(u=>u())},!1);class Le extends st{constructor(n,i){if(super(),this.binaryType=bv,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,n&&typeof n=="object"&&(i=n,n=null),n){const o=Es(n);i.hostname=o.host,i.secure=o.protocol==="https"||o.protocol==="wss",i.port=o.port,o.query&&(i.query=o.query)}else i.host&&(i.hostname=Es(i.host).host);Jr(this,i),this.secure=i.secure!=null?i.secure:typeof location<"u"&&location.protocol==="https:",i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=i.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},i.transports.forEach(o=>{const f=o.prototype.name;this.transports.push(f),this._transportsByName[f]=o}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Pv(this.opts.query)),Ps&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},qr.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(n){const i=Object.assign({},this.opts.query);i.EIO=Va,i.transport=n,this.id&&(i.sid=this.id);const o=Object.assign({},this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[n]);return new this._transportsByName[n](o)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const n=this.opts.rememberUpgrade&&Le.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const i=this.createTransport(n);i.open(),this.setTransport(i)}setTransport(n){this.transport&&this.transport.removeAllListeners(),this.transport=n,n.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",i=>this._onClose("transport close",i))}onOpen(){this.readyState="open",Le.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",n),this.emitReserved("heartbeat"),n.type){case"open":this.onHandshake(JSON.parse(n.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const i=new Error("server error");i.code=n.data,this._onError(i);break;case"message":this.emitReserved("data",n.data),this.emitReserved("message",n.data);break}}onHandshake(n){this.emitReserved("handshake",n),this.id=n.sid,this.transport.query.sid=n.sid,this._pingInterval=n.pingInterval,this._pingTimeout=n.pingTimeout,this._maxPayload=n.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const n=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+n,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},n),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const n=this._getWritablePackets();this.transport.send(n),this._prevBufferLen=n.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let i=1;for(let o=0;o<this.writeBuffer.length;o++){const f=this.writeBuffer[o].data;if(f&&(i+=Av(f)),o>0&&i>this._maxPayload)return this.writeBuffer.slice(0,o);i+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const n=Date.now()>this._pingTimeoutTime;return n&&(this._pingTimeoutTime=0,Vr(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),n}write(n,i,o){return this._sendPacket("message",n,i,o),this}send(n,i,o){return this._sendPacket("message",n,i,o),this}_sendPacket(n,i,o,f){if(typeof i=="function"&&(f=i,i=void 0),typeof o=="function"&&(f=o,o=null),this.readyState==="closing"||this.readyState==="closed")return;o=o||{},o.compress=o.compress!==!1;const _={type:n,data:i,options:o};this.emitReserved("packetCreate",_),this.writeBuffer.push(_),f&&this.once("flush",f),this.flush()}close(){const n=()=>{this._onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),n()},o=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?o():n()}):this.upgrading?o():n()),this}_onError(n){if(Le.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",n),this._onClose("transport error",n)}_onClose(n,i){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ps&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const o=qr.indexOf(this._offlineEventListener);o!==-1&&qr.splice(o,1)}this.readyState="closed",this.id=null,this.emitReserved("close",n,i),this.writeBuffer=[],this._prevBufferLen=0}}}Le.protocol=Va;class Kv extends Le{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let n=0;n<this._upgrades.length;n++)this._probe(this._upgrades[n])}_probe(n){let i=this.createTransport(n),o=!1;Le.priorWebsocketSuccess=!1;const f=()=>{o||(i.send([{type:"ping",data:"probe"}]),i.once("packet",F=>{if(!o)if(F.type==="pong"&&F.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",i),!i)return;Le.priorWebsocketSuccess=i.name==="websocket",this.transport.pause(()=>{o||this.readyState!=="closed"&&(tt(),this.setTransport(i),i.send([{type:"upgrade"}]),this.emitReserved("upgrade",i),i=null,this.upgrading=!1,this.flush())})}else{const Zt=new Error("probe error");Zt.transport=i.name,this.emitReserved("upgradeError",Zt)}}))};function _(){o||(o=!0,tt(),i.close(),i=null)}const b=F=>{const Zt=new Error("probe error: "+F);Zt.transport=i.name,_(),this.emitReserved("upgradeError",Zt)};function P(){b("transport closed")}function L(){b("socket closed")}function ht(F){i&&F.name!==i.name&&_()}const tt=()=>{i.removeListener("open",f),i.removeListener("error",b),i.removeListener("close",P),this.off("close",L),this.off("upgrading",ht)};i.once("open",f),i.once("error",b),i.once("close",P),this.once("close",L),this.once("upgrading",ht),this._upgrades.indexOf("webtransport")!==-1&&n!=="webtransport"?this.setTimeoutFn(()=>{o||i.open()},200):i.open()}onHandshake(n){this._upgrades=this._filterUpgrades(n.upgrades),super.onHandshake(n)}_filterUpgrades(n){const i=[];for(let o=0;o<n.length;o++)~this.transports.indexOf(n[o])&&i.push(n[o]);return i}}let Yv=class extends Kv{constructor(n,i={}){const o=typeof n=="object"?n:i;(!o.transports||o.transports&&typeof o.transports[0]=="string")&&(o.transports=(o.transports||["polling","websocket","webtransport"]).map(f=>Uv[f]).filter(f=>!!f)),super(n,o)}};function Xv(u,n="",i){let o=u;i=i||typeof location<"u"&&location,u==null&&(u=i.protocol+"//"+i.host),typeof u=="string"&&(u.charAt(0)==="/"&&(u.charAt(1)==="/"?u=i.protocol+u:u=i.host+u),/^(https?|wss?):\/\//.test(u)||(typeof i<"u"?u=i.protocol+"//"+u:u="https://"+u),o=Es(u)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";const _=o.host.indexOf(":")!==-1?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+_+":"+o.port+n,o.href=o.protocol+"://"+_+(i&&i.port===o.port?"":":"+o.port),o}const zv=typeof ArrayBuffer=="function",Vv=u=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(u):u.buffer instanceof ArrayBuffer,el=Object.prototype.toString,Jv=typeof Blob=="function"||typeof Blob<"u"&&el.call(Blob)==="[object BlobConstructor]",Zv=typeof File=="function"||typeof File<"u"&&el.call(File)==="[object FileConstructor]";function Ds(u){return zv&&(u instanceof ArrayBuffer||Vv(u))||Jv&&u instanceof Blob||Zv&&u instanceof File}function $r(u,n){if(!u||typeof u!="object")return!1;if(Array.isArray(u)){for(let i=0,o=u.length;i<o;i++)if($r(u[i]))return!0;return!1}if(Ds(u))return!0;if(u.toJSON&&typeof u.toJSON=="function"&&arguments.length===1)return $r(u.toJSON(),!0);for(const i in u)if(Object.prototype.hasOwnProperty.call(u,i)&&$r(u[i]))return!0;return!1}function Qv(u){const n=[],i=u.data,o=u;return o.data=Os(i,n),o.attachments=n.length,{packet:o,buffers:n}}function Os(u,n){if(!u)return u;if(Ds(u)){const i={_placeholder:!0,num:n.length};return n.push(u),i}else if(Array.isArray(u)){const i=new Array(u.length);for(let o=0;o<u.length;o++)i[o]=Os(u[o],n);return i}else if(typeof u=="object"&&!(u instanceof Date)){const i={};for(const o in u)Object.prototype.hasOwnProperty.call(u,o)&&(i[o]=Os(u[o],n));return i}return u}function jv(u,n){return u.data=Rs(u.data,n),delete u.attachments,u}function Rs(u,n){if(!u)return u;if(u&&u._placeholder===!0){if(typeof u.num=="number"&&u.num>=0&&u.num<n.length)return n[u.num];throw new Error("illegal attachments")}else if(Array.isArray(u))for(let i=0;i<u.length;i++)u[i]=Rs(u[i],n);else if(typeof u=="object")for(const i in u)Object.prototype.hasOwnProperty.call(u,i)&&(u[i]=Rs(u[i],n));return u}const tm=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],em=5;var $;(function(u){u[u.CONNECT=0]="CONNECT",u[u.DISCONNECT=1]="DISCONNECT",u[u.EVENT=2]="EVENT",u[u.ACK=3]="ACK",u[u.CONNECT_ERROR=4]="CONNECT_ERROR",u[u.BINARY_EVENT=5]="BINARY_EVENT",u[u.BINARY_ACK=6]="BINARY_ACK"})($||($={}));class nm{constructor(n){this.replacer=n}encode(n){return(n.type===$.EVENT||n.type===$.ACK)&&$r(n)?this.encodeAsBinary({type:n.type===$.EVENT?$.BINARY_EVENT:$.BINARY_ACK,nsp:n.nsp,data:n.data,id:n.id}):[this.encodeAsString(n)]}encodeAsString(n){let i=""+n.type;return(n.type===$.BINARY_EVENT||n.type===$.BINARY_ACK)&&(i+=n.attachments+"-"),n.nsp&&n.nsp!=="/"&&(i+=n.nsp+","),n.id!=null&&(i+=n.id),n.data!=null&&(i+=JSON.stringify(n.data,this.replacer)),i}encodeAsBinary(n){const i=Qv(n),o=this.encodeAsString(i.packet),f=i.buffers;return f.unshift(o),f}}function Ea(u){return Object.prototype.toString.call(u)==="[object Object]"}class Ws extends st{constructor(n){super(),this.reviver=n}add(n){let i;if(typeof n=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");i=this.decodeString(n);const o=i.type===$.BINARY_EVENT;o||i.type===$.BINARY_ACK?(i.type=o?$.EVENT:$.ACK,this.reconstructor=new rm(i),i.attachments===0&&super.emitReserved("decoded",i)):super.emitReserved("decoded",i)}else if(Ds(n)||n.base64)if(this.reconstructor)i=this.reconstructor.takeBinaryData(n),i&&(this.reconstructor=null,super.emitReserved("decoded",i));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+n)}decodeString(n){let i=0;const o={type:Number(n.charAt(0))};if($[o.type]===void 0)throw new Error("unknown packet type "+o.type);if(o.type===$.BINARY_EVENT||o.type===$.BINARY_ACK){const _=i+1;for(;n.charAt(++i)!=="-"&&i!=n.length;);const b=n.substring(_,i);if(b!=Number(b)||n.charAt(i)!=="-")throw new Error("Illegal attachments");o.attachments=Number(b)}if(n.charAt(i+1)==="/"){const _=i+1;for(;++i&&!(n.charAt(i)===","||i===n.length););o.nsp=n.substring(_,i)}else o.nsp="/";const f=n.charAt(i+1);if(f!==""&&Number(f)==f){const _=i+1;for(;++i;){const b=n.charAt(i);if(b==null||Number(b)!=b){--i;break}if(i===n.length)break}o.id=Number(n.substring(_,i+1))}if(n.charAt(++i)){const _=this.tryParse(n.substr(i));if(Ws.isPayloadValid(o.type,_))o.data=_;else throw new Error("invalid payload")}return o}tryParse(n){try{return JSON.parse(n,this.reviver)}catch{return!1}}static isPayloadValid(n,i){switch(n){case $.CONNECT:return Ea(i);case $.DISCONNECT:return i===void 0;case $.CONNECT_ERROR:return typeof i=="string"||Ea(i);case $.EVENT:case $.BINARY_EVENT:return Array.isArray(i)&&(typeof i[0]=="number"||typeof i[0]=="string"&&tm.indexOf(i[0])===-1);case $.ACK:case $.BINARY_ACK:return Array.isArray(i)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class rm{constructor(n){this.packet=n,this.buffers=[],this.reconPack=n}takeBinaryData(n){if(this.buffers.push(n),this.buffers.length===this.reconPack.attachments){const i=jv(this.reconPack,this.buffers);return this.finishedReconstruction(),i}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const im=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Ws,Encoder:nm,get PacketType(){return $},protocol:em},Symbol.toStringTag,{value:"Module"}));function Jt(u,n,i){return u.on(n,i),function(){u.off(n,i)}}const sm=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class nl extends st{constructor(n,i,o){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=n,this.nsp=i,o&&o.auth&&(this.auth=o.auth),this._opts=Object.assign({},o),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const n=this.io;this.subs=[Jt(n,"open",this.onopen.bind(this)),Jt(n,"packet",this.onpacket.bind(this)),Jt(n,"error",this.onerror.bind(this)),Jt(n,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...n){return n.unshift("message"),this.emit.apply(this,n),this}emit(n,...i){var o,f,_;if(sm.hasOwnProperty(n))throw new Error('"'+n.toString()+'" is a reserved event name');if(i.unshift(n),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(i),this;const b={type:$.EVENT,data:i};if(b.options={},b.options.compress=this.flags.compress!==!1,typeof i[i.length-1]=="function"){const tt=this.ids++,F=i.pop();this._registerAckCallback(tt,F),b.id=tt}const P=(f=(o=this.io.engine)===null||o===void 0?void 0:o.transport)===null||f===void 0?void 0:f.writable,L=this.connected&&!(!((_=this.io.engine)===null||_===void 0)&&_._hasPingExpired());return this.flags.volatile&&!P||(L?(this.notifyOutgoingListeners(b),this.packet(b)):this.sendBuffer.push(b)),this.flags={},this}_registerAckCallback(n,i){var o;const f=(o=this.flags.timeout)!==null&&o!==void 0?o:this._opts.ackTimeout;if(f===void 0){this.acks[n]=i;return}const _=this.io.setTimeoutFn(()=>{delete this.acks[n];for(let P=0;P<this.sendBuffer.length;P++)this.sendBuffer[P].id===n&&this.sendBuffer.splice(P,1);i.call(this,new Error("operation has timed out"))},f),b=(...P)=>{this.io.clearTimeoutFn(_),i.apply(this,P)};b.withError=!0,this.acks[n]=b}emitWithAck(n,...i){return new Promise((o,f)=>{const _=(b,P)=>b?f(b):o(P);_.withError=!0,i.push(_),this.emit(n,...i)})}_addToQueue(n){let i;typeof n[n.length-1]=="function"&&(i=n.pop());const o={id:this._queueSeq++,tryCount:0,pending:!1,args:n,flags:Object.assign({fromQueue:!0},this.flags)};n.push((f,..._)=>o!==this._queue[0]?void 0:(f!==null?o.tryCount>this._opts.retries&&(this._queue.shift(),i&&i(f)):(this._queue.shift(),i&&i(null,..._)),o.pending=!1,this._drainQueue())),this._queue.push(o),this._drainQueue()}_drainQueue(n=!1){if(!this.connected||this._queue.length===0)return;const i=this._queue[0];i.pending&&!n||(i.pending=!0,i.tryCount++,this.flags=i.flags,this.emit.apply(this,i.args))}packet(n){n.nsp=this.nsp,this.io._packet(n)}onopen(){typeof this.auth=="function"?this.auth(n=>{this._sendConnectPacket(n)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(n){this.packet({type:$.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},n):n})}onerror(n){this.connected||this.emitReserved("connect_error",n)}onclose(n,i){this.connected=!1,delete this.id,this.emitReserved("disconnect",n,i),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(n=>{if(!this.sendBuffer.some(o=>String(o.id)===n)){const o=this.acks[n];delete this.acks[n],o.withError&&o.call(this,new Error("socket has been disconnected"))}})}onpacket(n){if(n.nsp===this.nsp)switch(n.type){case $.CONNECT:n.data&&n.data.sid?this.onconnect(n.data.sid,n.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case $.EVENT:case $.BINARY_EVENT:this.onevent(n);break;case $.ACK:case $.BINARY_ACK:this.onack(n);break;case $.DISCONNECT:this.ondisconnect();break;case $.CONNECT_ERROR:this.destroy();const o=new Error(n.data.message);o.data=n.data.data,this.emitReserved("connect_error",o);break}}onevent(n){const i=n.data||[];n.id!=null&&i.push(this.ack(n.id)),this.connected?this.emitEvent(i):this.receiveBuffer.push(Object.freeze(i))}emitEvent(n){if(this._anyListeners&&this._anyListeners.length){const i=this._anyListeners.slice();for(const o of i)o.apply(this,n)}super.emit.apply(this,n),this._pid&&n.length&&typeof n[n.length-1]=="string"&&(this._lastOffset=n[n.length-1])}ack(n){const i=this;let o=!1;return function(...f){o||(o=!0,i.packet({type:$.ACK,id:n,data:f}))}}onack(n){const i=this.acks[n.id];typeof i=="function"&&(delete this.acks[n.id],i.withError&&n.data.unshift(null),i.apply(this,n.data))}onconnect(n,i){this.id=n,this.recovered=i&&this._pid===i,this._pid=i,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(n=>this.emitEvent(n)),this.receiveBuffer=[],this.sendBuffer.forEach(n=>{this.notifyOutgoingListeners(n),this.packet(n)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(n=>n()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:$.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(n){return this.flags.compress=n,this}get volatile(){return this.flags.volatile=!0,this}timeout(n){return this.flags.timeout=n,this}onAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(n),this}prependAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(n),this}offAny(n){if(!this._anyListeners)return this;if(n){const i=this._anyListeners;for(let o=0;o<i.length;o++)if(n===i[o])return i.splice(o,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(n),this}prependAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(n),this}offAnyOutgoing(n){if(!this._anyOutgoingListeners)return this;if(n){const i=this._anyOutgoingListeners;for(let o=0;o<i.length;o++)if(n===i[o])return i.splice(o,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(n){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const i=this._anyOutgoingListeners.slice();for(const o of i)o.apply(this,n.data)}}}function cn(u){u=u||{},this.ms=u.min||100,this.max=u.max||1e4,this.factor=u.factor||2,this.jitter=u.jitter>0&&u.jitter<=1?u.jitter:0,this.attempts=0}cn.prototype.duration=function(){var u=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var n=Math.random(),i=Math.floor(n*this.jitter*u);u=(Math.floor(n*10)&1)==0?u-i:u+i}return Math.min(u,this.max)|0};cn.prototype.reset=function(){this.attempts=0};cn.prototype.setMin=function(u){this.ms=u};cn.prototype.setMax=function(u){this.max=u};cn.prototype.setJitter=function(u){this.jitter=u};let Is=class extends st{constructor(n,i){var o;super(),this.nsps={},this.subs=[],n&&typeof n=="object"&&(i=n,n=void 0),i=i||{},i.path=i.path||"/socket.io",this.opts=i,Jr(this,i),this.reconnection(i.reconnection!==!1),this.reconnectionAttempts(i.reconnectionAttempts||1/0),this.reconnectionDelay(i.reconnectionDelay||1e3),this.reconnectionDelayMax(i.reconnectionDelayMax||5e3),this.randomizationFactor((o=i.randomizationFactor)!==null&&o!==void 0?o:.5),this.backoff=new cn({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(i.timeout==null?2e4:i.timeout),this._readyState="closed",this.uri=n;const f=i.parser||im;this.encoder=new f.Encoder,this.decoder=new f.Decoder,this._autoConnect=i.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(n){return arguments.length?(this._reconnection=!!n,n||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(n){return n===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=n,this)}reconnectionDelay(n){var i;return n===void 0?this._reconnectionDelay:(this._reconnectionDelay=n,(i=this.backoff)===null||i===void 0||i.setMin(n),this)}randomizationFactor(n){var i;return n===void 0?this._randomizationFactor:(this._randomizationFactor=n,(i=this.backoff)===null||i===void 0||i.setJitter(n),this)}reconnectionDelayMax(n){var i;return n===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=n,(i=this.backoff)===null||i===void 0||i.setMax(n),this)}timeout(n){return arguments.length?(this._timeout=n,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(n){if(~this._readyState.indexOf("open"))return this;this.engine=new Yv(this.uri,this.opts);const i=this.engine,o=this;this._readyState="opening",this.skipReconnect=!1;const f=Jt(i,"open",function(){o.onopen(),n&&n()}),_=P=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",P),n?n(P):this.maybeReconnectOnOpen()},b=Jt(i,"error",_);if(this._timeout!==!1){const P=this._timeout,L=this.setTimeoutFn(()=>{f(),_(new Error("timeout")),i.close()},P);this.opts.autoUnref&&L.unref(),this.subs.push(()=>{this.clearTimeoutFn(L)})}return this.subs.push(f),this.subs.push(b),this}connect(n){return this.open(n)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const n=this.engine;this.subs.push(Jt(n,"ping",this.onping.bind(this)),Jt(n,"data",this.ondata.bind(this)),Jt(n,"error",this.onerror.bind(this)),Jt(n,"close",this.onclose.bind(this)),Jt(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(n){try{this.decoder.add(n)}catch(i){this.onclose("parse error",i)}}ondecoded(n){Vr(()=>{this.emitReserved("packet",n)},this.setTimeoutFn)}onerror(n){this.emitReserved("error",n)}socket(n,i){let o=this.nsps[n];return o?this._autoConnect&&!o.active&&o.connect():(o=new nl(this,n,i),this.nsps[n]=o),o}_destroy(n){const i=Object.keys(this.nsps);for(const o of i)if(this.nsps[o].active)return;this._close()}_packet(n){const i=this.encoder.encode(n);for(let o=0;o<i.length;o++)this.engine.write(i[o],n.options)}cleanup(){this.subs.forEach(n=>n()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(n,i){var o;this.cleanup(),(o=this.engine)===null||o===void 0||o.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",n,i),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const n=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const i=this.backoff.duration();this._reconnecting=!0;const o=this.setTimeoutFn(()=>{n.skipReconnect||(this.emitReserved("reconnect_attempt",n.backoff.attempts),!n.skipReconnect&&n.open(f=>{f?(n._reconnecting=!1,n.reconnect(),this.emitReserved("reconnect_error",f)):n.onreconnect()}))},i);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}}onreconnect(){const n=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",n)}};const Dn={};function Kr(u,n){typeof u=="object"&&(n=u,u=void 0),n=n||{};const i=Xv(u,n.path||"/socket.io"),o=i.source,f=i.id,_=i.path,b=Dn[f]&&_ in Dn[f].nsps,P=n.forceNew||n["force new connection"]||n.multiplex===!1||b;let L;return P?L=new Is(o,n):(Dn[f]||(Dn[f]=new Is(o,n)),L=Dn[f]),i.query&&!n.query&&(n.query=i.queryKey),L.socket(i.path,n)}Object.assign(Kr,{Manager:Is,Socket:nl,io:Kr,connect:Kr});function om(u){const n=u.get("gameId"),i=u.get("playerId"),o=u.get("opponentId"),f=u.get("gameName"),_=u.get("lobbyId"),b=u.get("lobbyCode");return{gameId:n,playerId:i,opponentId:o,gameName:f,lobbyId:_,lobbyCode:b}}const rl=new URL(window.location.href);console.log(rl);const um=rl.search,am=new URLSearchParams(um),Ls=om(am);console.log(Ls);const y={serverData:Ls,mouseDown:!1,firstPlay:!0,cue:{x:413,y:413},opponentInvalidCue:!1,isDraggingCue:!1,cueStartPos:{x:100,y:100},stickAngle:0,isRotating:!1,previousAngle:0,socket:Kr("https://game-service-uny2.onrender.com/snooker"),currentTurn:1,myPlayerNumber:0,started:!1,lobbyCode:Ls.lobbyCode,waiting:document.getElementById("waiting"),domTurn:document.getElementById("turn"),domTime:document.getElementById("time"),p1aDiv:document.getElementById("p1a-div"),p1a:document.getElementById("p1a"),p1u:document.getElementById("p1u"),p2aDiv:document.getElementById("p2a-div"),p2a:document.getElementById("p2a"),p2u:document.getElementById("p2u")};function xt(){return y.myPlayerNumber==y.currentTurn}function il(u,n,i,o){const f=ul(u,o),_=f.x/n,b=f.y/i;if(y.cue&&vm(_,b,y.cue.x,y.cue.y)<=19&&(y.opponentInvalidCue||y.firstPlay)){y.isDraggingCue=!0,y.cueStartPos={x:y.cue.x,y:y.cue.y},o.style.cursor="grabbing";return}else console.log("rotating????"),y.isRotating=!0,ol(u,n,i,o)}function sl(u,n,i,o){if((!y.isDraggingCue||!y.cue)&&y.mouseDown){if(console.log("stick??"),!y.isRotating)return;ol(u,n,i,o);return}if(!y.mouseDown)return;u.preventDefault();const f=ul(u,o),_=f.x/n,b=f.y/i;if(y.cue.x=_,y.cue.y=b,y.firstPlay)if(y.cue.x>413){console.log("invalid");return}else y.socket.emit("move_cue",y.lobbyCode,{x:y.cue.x,y:y.cue.y});else y.socket.emit("move_cue",y.lobbyCode,{x:y.cue.x,y:y.cue.y})}function Fs(u){y.isDraggingCue&&(y.isDraggingCue=!1,u.style.cursor="",(y.cue.x!==y.cueStartPos.x||y.cue.y!==y.cueStartPos.y)&&y.socket.emit("move_cue",y.lobbyCode,{x:y.cue.x,y:y.cue.y})),lm()}function lm(){y.isRotating=!1}function ol(u,n,i,o){const f=o.getBoundingClientRect(),_=u.clientX||u.touches[0].clientX,b=u.clientY||u.touches[0].clientY,P=(_-f.left)/n,L=(b-f.top)/i;y.previousAngle=y.stickAngle,y.stickAngle=Math.atan2(L-y.cue.y,P-y.cue.x),cm(y.stickAngle)}function cm(u){y.socket.emit("rotate_stick",y.lobbyCode,u)}const Us=document.createElement("div");Us.id="base";const ct=document.createElement("div");ct.id="power";Us.appendChild(ct);document.body.appendChild(Us);let Hs=!1;const Yr=200;let ke,hn,lt,Xr=0;function hm(u){console.log("touch start"),ke=u.touches[0].pageX,hn=u.touches[0].pageY}function fm(u){ke-u.touches[0].pageX,lt=Math.abs(hn-u.touches[0].pageY),lt>0&&lt<=ct.clientWidth?ct.style.translate=`${lt*-1}px 0`:lt<=0&&(lt=0)}function dm(u){lt>0&&(Xr=lt>ct.clientWidth?Yr:lt/ct.clientWidth*Yr,y.socket.emit("strike",y.lobbyCode,{angle:y.stickAngle,force:Xr}),y.firstPlay=!1,y.opponentInvalidCue=!1),ke=0,hn=0,ct.style.translate=`${ke}px 0`}function pm(u){ke=u.pageX,hn=u.pageY}function gm(u){ke-u.pageX,lt=Math.abs(hn-u.pageY),lt>0&&lt<=ct.clientWidth?ct.style.translate=`${lt*-1}px 0`:lt<=0&&(lt=0)}function _m(u){lt>0&&(Xr=lt>ct.clientWidth?Yr:lt/ct.clientWidth*Yr,console.log("strike"),y.socket.emit("strike",y.lobbyCode,{angle:y.stickAngle,force:Xr}),y.firstPlay=!1,y.opponentInvalidCue=!1),ke=0,hn=0,ct.style.translate=`${ke}px 0`}ct.addEventListener("mousedown",u=>{y.started&&xt()&&(Hs=!0,console.log("handle start"),pm(u))});ct.addEventListener("mousemove",u=>{y.started&&xt()&&Hs&&(console.log("handle move"),gm(u))});ct.addEventListener("mouseup",u=>{y.started&&xt()&&(Hs=!1,_m())});ct.addEventListener("touchstart",u=>{y.started&&xt()&&hm(u)});ct.addEventListener("touchmove",u=>{y.started&&xt()&&fm(u)});ct.addEventListener("touchend",u=>{y.started&&xt()&&dm()});function ul(u,n){const i=n.getBoundingClientRect();return{x:(u.clientX||u.touches[0].clientX)-i.left,y:(u.clientY||u.touches[0].clientY)-i.top}}function vm(u,n,i,o){return Math.sqrt((i-u)**2+(o-n)**2)}async function mm(u){try{const n=await fetch(`https://game-service-uny2.onrender.com/user-details/${u}`);if(!n.ok)return alert("error fetching avatar and username, default data used"),{username:"user",avatar:"https://game-service-uny2.onrender.com/game/Scrabble/a1.png"};const i=await n.json();return{username:i.userGameDetails.username,avatar:i.userGameDetails.avatar}}catch(n){return alert("error fetching avatar and username, default data used"),console.log(n),{username:"user",avatar:"https://game-service-uny2.onrender.com/game/Scrabble/a1.png"}}}class ym{constructor(n,i){A(this,"_canvasContainer");A(this,"_canvas");A(this,"_context");A(this,"_scale");A(this,"_offset");this._canvasContainer=i,this._canvas=n,this._context=this._canvas.getContext("2d"),this.resizeCanvas()}get scaleX(){return this._scale.x}get scaleY(){return this._scale.y}get offsetX(){return this._offset.x}get offsetY(){return this._offset.y}resizeCanvas(){const n=E.gameSize.x,i=E.gameSize.y,o=n/i;let f=window.innerHeight/1.3,_=window.innerWidth/1.3;_/f>o?_=f*o:f=_/o,this._canvasContainer.style.width=_+"px",this._canvasContainer.style.height=f+"px",this._scale=new D(_/n,f/i),this._canvas.width=_,this._canvas.height=f,this._canvas.offsetParent&&(this._offset=new D(this._canvas.offsetLeft,this._canvas.offsetTop))}clear(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}drawImage(n,i={x:0,y:0},o=0,f={x:0,y:0}){this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.translate(i.x,i.y),this._context.rotate(o),this._context.drawImage(n,0,0,n.width,n.height,-f.x,-f.y,n.width,n.height),this._context.restore()}drawText(n,i,o,f,_="left"){this._context.save(),this._context.scale(this._scale.x,this._scale.y),this._context.fillStyle=o,this._context.font=i,this._context.textAlign=_,this._context.fillText(n,f.x,f.y),this._context.restore()}changeCursor(n){this._canvas.style.cursor=n}}const bt=document.getElementById("screen"),wm=document.getElementById("gameArea"),z=new ym(bt,wm);window.addEventListener("resize",z.resizeCanvas.bind(z));bt.addEventListener("mousedown",u=>{console.log(y.started),xt()&&y.started&&(y.mouseDown=!0,il(u,z.scaleX,z.scaleY,bt))});bt.addEventListener("mousemove",u=>{y.started&&xt()&&sl(u,z.scaleX,z.scaleY,bt)});bt.addEventListener("mouseup",u=>{y.started&&xt()&&(y.mouseDown=!1,Fs(bt))});bt.addEventListener("mouseleave",u=>{y.started&&xt()&&(y.mouseDown=!1,Fs(bt))});bt.addEventListener("touchstart",u=>{y.started&&xt()&&(y.mouseDown=!0,il(u,z.scaleX,z.scaleY,bt))});bt.addEventListener("touchmove",u=>{y.started&&xt()&&sl(u,z.scaleX,z.scaleY,bt)});bt.addEventListener("touchend",u=>{y.started&&xt()&&(y.mouseDown=!1,Fs(bt))});class xm{constructor(){A(this,"_buttonStates",[]);A(this,"_position");for(let n=0;n<3;n++)this._buttonStates[n]=new qa;this._position=D.zero,document.addEventListener("mousemove",n=>this.handleMouseMove(n)),document.addEventListener("mousedown",n=>this.handleMouseDown(n)),document.addEventListener("mouseup",n=>this.handleMouseUp(n))}get position(){return D.copy(this._position)}handleMouseMove(n){const i=(n.pageX-z.offsetX)/z.scaleX,o=(n.pageY-z.offsetY)/z.scaleY;this._position=new D(i,o)}handleMouseDown(n){this._buttonStates[n.button].down=!0,this._buttonStates[n.button].pressed=!0}handleMouseUp(n){this._buttonStates[n.button].down=!1}reset(){for(let n=0;n<3;n++)this._buttonStates[n].pressed=!1}isDown(n){return this._buttonStates[n].down}isPressed(n){return this._buttonStates[n].pressed}}const ye=new xm,{cloneDeep:Pa}=fv,Wn=E.ai,Oa=E.stick;class bm{constructor(){A(this,"_policy");A(this,"_opponents");A(this,"_currentOpponent");A(this,"_initialGameWorld");A(this,"_gameWorld");A(this,"_iteration",0);A(this,"_finishedSession",!0);A(this,"_bestOpponent");A(this,"_soundOnState");this._policy=new uv}get finishedSession(){return this._finishedSession}placeBallInHand(n){debugger;let i=5,o=D.copy(E.cueBallPosition);for(;!n.isValidPosToPlaceCueBall(o);)o.addToX(i);n.placeBallInHand(o)}init(){this._opponents=[],this._currentOpponent=this.createRandomOpponent(),this._bestOpponent=this._currentOpponent,this._iteration=0}createMutation(n){let i=n.power;i+=Math.random()*2*Wn.shotPowerMutationVariance-Wn.shotPowerMutationVariance,i=i<Wn.minShotPower?Wn.minShotPower:i,i=i>Oa.maxPower?Oa.maxPower:i;let o=n.rotation;return n.evaluation>0?o+=1/n.evaluation*(Math.random()*2*Math.PI-Math.PI):o=Math.random()*2*Math.PI-Math.PI,new ys(i,o)}createRandomOpponent(){const n=Math.random()*75+1,i=Math.random()*2*Math.PI;return new ys(n,i)}train(){if(this._iteration===Wn.trainIterations){E.soundOn=this._soundOnState,this.playTurn(),this._finishedSession=!0;return}if(this._gameWorld.isBallsMoving)return;this._gameWorld.concludeTurn(),this._currentOpponent.evaluation=this._policy.evaluate(this._gameWorld);const n=new ys(this._currentOpponent.power,this._currentOpponent.rotation,this._currentOpponent.evaluation);this._opponents.push(n),n.evaluation>this._bestOpponent.evaluation&&(this._bestOpponent=n),this._gameWorld=Pa(this._initialGameWorld),this._currentOpponent=this.buildNewOpponent(),this._iteration++,this.simulate()}buildNewOpponent(){return this._iteration%10===0?this.createRandomOpponent():this.createMutation(this._bestOpponent)}playTurn(){this._initialGameWorld.shootCueBall(this._bestOpponent.power,this._bestOpponent.rotation)}simulate(){this._gameWorld.shootCueBall(this._currentOpponent.power,this._currentOpponent.rotation)}opponentTrainingLoop(){for(;!this._finishedSession;)this.train(),this._gameWorld.update();ye.reset()}startSession(n){this._soundOnState=E.soundOn,E.soundOn=!1,n.isBallInHand&&this.placeBallInHand(n),this._initialGameWorld=n,this._gameWorld=Pa(n),this.init(),this._finishedSession=!1,this.simulate(),this.opponentTrainingLoop()}}const Hn=new bm;class Sm{constructor(n){this._game=n}execute(){this._game.goToPreviousMenu()}}class Bm{constructor(n){this._game=n}execute(n){this._game.goToSubMenu(n)}}const Re=E.sprites;class Tm{toggleMuteButtonSprite(){const n=Re.paths.muteButton,i=Re.paths.muteButtonHovered;Re.paths.muteButton=Re.paths.muteButtonPressed,Re.paths.muteButtonHovered=Re.paths.muteButtonPressedHovered,Re.paths.muteButtonPressed=n,Re.paths.muteButtonPressedHovered=i}execute(){E.soundOn=!E.soundOn,this.toggleMuteButtonSprite()}}class Am{constructor(n){this._game=n}execute(n){E.ai.playerIndex=Math.floor(Math.random()*2),E.ai.on=!0,E.ai.trainIterations=n,this._game.start()}}class Cm{constructor(n){this._game=n}execute(){E.ai.on=!1,this._game.start()}}const Ss=E.sprites,Ra=E.sounds;class Em{constructor(){A(this,"_sprites");A(this,"_sounds");this._sprites=new Map,this._sounds=new Map}loadSprite(n){const i=new Image;return this._sprites.set(n,i),new Promise(o=>{i.onload=()=>o(),i.src=Ss.basePath+n})}loadSprite2(n){return new Promise(i=>{const o=new Image;o.onload=()=>{const f=document.createElement("canvas"),_=f.getContext("2d");f.width=o.width/2,f.height=o.height/2,_&&_.drawImage(o,0,0,f.width,f.height);const b=new Image;b.onload=()=>{this._sprites.set(n,b),i()},b.src=f.toDataURL()},o.src=Ss.basePath+n})}async loadGameSprites(){const n=Object.values(Ss.paths).map(this.loadSprite.bind(this));await Promise.all(n)}loadSound(n){const i=new Audio(Ra.basePath+n);return this._sounds.set(n,i),i.load(),new Promise(o=>{i.onloadeddata=()=>o()})}async loadGameSounds(){const n=Object.values(Ra.paths).map(this.loadSound.bind(this));await Promise.all(n)}async loadGameAssets(){await this.loadGameSounds(),await this.loadGameSprites()}getSprite(n){return this._sprites.get(n)}getSound(n){return this._sounds.get(n).cloneNode(!0)}playSound(n,i){if(E.soundOn){const o=this.getSound(n);o.volume=i,o.play()}}}const pt=new Em,Pm=E.input,Ia=E.cursor,Bs=E.sprites;class Om{constructor(n,i,o,f,_){A(this,"_activeSprite");A(this,"_hovered");this._command=n,this._value=i,this._position=o,this._spriteKey=f,this._spriteOnHoverKey=_,this._activeSprite=pt.getSprite(Bs.paths[this._spriteKey])}set hovered(n){this._hovered=n}isInsideButton(n){return n.x>this._position.x&&n.x<this._position.x+this._activeSprite.width&&n.y>this._position.y&&n.y<this._position.y+this._activeSprite.height}handleInput(){this.hovered=this.isInsideButton(ye.position),this._activeSprite=this._hovered?pt.getSprite(Bs.paths[this._spriteOnHoverKey]):pt.getSprite(Bs.paths[this._spriteKey]),this._hovered&&ye.isPressed(Pm.mouseSelectButton)&&(z.changeCursor(Ia.default),this._command.execute(this._value))}update(){this.handleInput()}draw(){this._hovered&&z.changeCursor(Ia.button),z.drawImage(this._activeSprite,this._position)}}class Rm{constructor(n,i,o,f,_){this._text=n,this._position=i,this._font=o,this._color=f,this._alignment=_}draw(){z.drawText(this._text,this._font,this._color,this._position,this._alignment)}}const Im=E.cursor,Lm=E.sprites;class Gs{constructor(){A(this,"_labels");A(this,"_buttons");A(this,"_active");A(this,"_subMenus")}set active(n){this._active=n}get active(){return this._active}init(n,i){this._buttons=i.buttons.map(o=>new Om(n.get(o.action),o.value,o.position,o.sprite,o.spriteOnHover)),this._labels=i.labels.map(o=>new Rm(o.text,o.position,o.font,o.color,o.alignment)),this._subMenus=i.subMenus.map(o=>{const f=new Gs;return f.init(n,o),f})}getSubMenu(n){return this._subMenus[n]}update(){this._active&&this._buttons.forEach(n=>n.update()),this._subMenus.forEach(n=>n.update())}draw(){this._active&&(z.changeCursor(Im.default),z.drawImage(pt.getSprite(Lm.paths.menuBackground)),this._labels.forEach(n=>n.draw()),this._buttons.forEach(n=>n.draw())),this._subMenus.forEach(n=>n.draw())}}const al=(u,n,i,o,f)=>{let _=(u-n)*(f-o)/(i-n)+o;return _=_<o?o:_,_=_>f?f:_,_};var V=(u=>(u.white="#BABABA",u.black="#2B2B2B",u.red="#B62A2F",u.yellow="#FECA34",u))(V||{});class km{isValidFirstTouch(n,i,o){return i?n.color?n.color===i||n.matchScore===1&&o&&i!==V.black||n.matchScore===7&&i===V.black||n.matchScore===8&&i===V.black:i!==V.black:!1}isValidPocketedBalls(n,i){if(i.length===0)return!0;if(n.color)return n.matchScore===8?i.length===1&&i[0].color===V.black:i.every(o=>o.color===n.color);{const o=i[0].color;return o!==V.white&&o!==V.black&&i.every(f=>f.color===o)}}isValidTurn(n,i){return this.isValidFirstTouch(n,i.firstCollidedBallColor,i.pocketedBalls.length>0)&&this.isValidPocketedBalls(n,i.pocketedBalls)}isGameOver(n,i,o){return!o.visible||!i.visible&&n.matchScore===7||!i.visible&&n.matchScore===8}}class La{constructor(){A(this,"color");A(this,"matchScore",0);A(this,"overallScore",0)}}class Mm{constructor(){A(this,"_keyStates",[]);for(let n=0;n<256;n++)this._keyStates[n]=new qa;document.addEventListener("keyup",n=>this.handleKeyUp(n)),document.addEventListener("keydown",n=>this.handleKeyDown(n))}handleKeyUp(n){this._keyStates[n.keyCode].down=!1}handleKeyDown(n){this._keyStates[n.keyCode].pressed=!0,this._keyStates[n.keyCode].down=!0}reset(){for(let n=0;n<256;n++)this._keyStates[n].pressed=!1}isDown(n){return this._keyStates[n].down}isPressed(n){return this._keyStates[n].pressed}}const zr=new Mm,ka=E.input,Ie=E.stick,Nm=E.sprites,Dm=E.sounds;class Wm{constructor(n){A(this,"_sprite",pt.getSprite(Nm.paths.stick));A(this,"_rotation",0);A(this,"_origin",D.copy(Ie.origin));A(this,"_power",0);A(this,"_movable",!0);A(this,"_visible",!0);this._position=n}get position(){return D.copy(this._position)}get rotation(){return this._rotation}get power(){return this._power}set movable(n){this._movable=n}get visible(){return this._visible}set visible(n){this._visible=n}set rotation(n){this._rotation=n}increasePower(){this._power+=Ie.powerToAddPerFrame,this._origin.addToX(Ie.movementPerFrame)}decreasePower(){this._power-=Ie.powerToAddPerFrame,this._origin.addToX(-3)}isLessThanMaxPower(){return this._power<Ie.maxPower}isMoreThanMinPower(){return this._power>=0}updatePower(){zr.isDown(ka.increaseShotPowerKey)&&this.isLessThanMaxPower()?this.increasePower():zr.isDown(ka.decreaseShotPowerKey)&&this.isMoreThanMinPower()&&this.decreasePower()}updateRotation(n){this._rotation=n}hide(){this._power=0,this._visible=!1,this._movable=!1}show(n){this._position=n,this._origin=D.copy(Ie.origin),this._movable=!0,this._visible=!0}shoot(){this._origin=D.copy(Ie.shotOrigin);const n=al(this._power,0,Ie.maxPower,0,1);pt.playSound(Dm.paths.strike,n)}update(n){this._movable&&(this.updateRotation(n),this.updatePower())}draw(){this._visible&&z.drawImage(this._sprite,this._position,this._rotation,this._origin)}}const Ma=E.physics,Ur=E.sprites,Na=E.ball;class Gn{constructor(n,i){A(this,"_sprite");A(this,"_color");A(this,"_velocity",D.zero);A(this,"_moving",!1);A(this,"_visible",!0);this._position=n,this._color=i,this.resolveSprite(i)}get position(){return D.copy(this._position)}set position(n){this._position=n}get nextPosition(){return this.position.add(this._velocity.mult(1-Ma.friction))}get velocity(){return D.copy(this._velocity)}set velocity(n){this._moving=n.length>0,this._velocity=n}get moving(){return this._moving}get color(){return this._color}get visible(){return this._visible}resolveSprite(n){switch(n){case V.white:this._sprite=pt.getSprite(Ur.paths.cueBall);break;case V.black:this._sprite=pt.getSprite(Ur.paths.blackBall);break;case V.red:this._sprite=pt.getSprite(Ur.paths.redBall);break;case V.yellow:this._sprite=pt.getSprite(Ur.paths.yellowBall);break}}shoot(n,i){this._velocity=new D(n*Math.cos(i),n*Math.sin(i)),this._moving=!0}show(n){this._position=n,this._velocity=D.zero,this._visible=!0}hide(){this._velocity=D.zero,this._moving=!1,this._visible=!1}update(){this._moving&&(this._velocity.multBy(1-Ma.friction),this._position.addTo(this._velocity),this._velocity.length<Na.minVelocityLength&&(this.velocity=D.zero,this._moving=!1))}draw(){this._visible&&z.drawImage(this._sprite,this._position,0,Na.origin)}}class Da{constructor(){A(this,"firstCollidedBallColor");A(this,"pocketedBalls",[]);A(this,"ballInHand",!1);A(this,"isValid",!1)}}const Ts=E.physics,Wa=E.input,Ht=E.ball,ne=E.table,me=E.labels,Fa=E.matchScore,Ua=E.ai,Hr=E.gameSize,As=E.sprites,Ha=E.sounds;class Ga{constructor(){A(this,"_stick");A(this,"_cueBall");A(this,"_8Ball");A(this,"_balls");A(this,"_players",[new La,new La]);A(this,"_currentPlayerIndex",0);A(this,"_turnState");A(this,"_referee");this.initMatch()}get currentPlayer(){return this._players[this._currentPlayerIndex]}get nextPlayer(){return this._players[(this._currentPlayerIndex+1)%this._players.length]}get balls(){return this._balls}get isBallInHand(){return this._turnState.ballInHand}get isTurnValid(){return this._turnState.isValid}get isGameOver(){return this._referee.isGameOver(this.currentPlayer,this._cueBall,this._8Ball)}get isBallsMoving(){return this._balls.some(n=>n.moving)}get numOfPocketedBallsOnTurn(){return this._turnState.pocketedBalls.length}getBallsByColor(n){return this._balls.filter(i=>i.color===n)}handleInput(){Hn.finishedSession&&ye.isPressed(Wa.mouseShootButton)&&this.shootCueBall(this._stick.power,this._stick.rotation)}isBallPosOutsideTopBorder(n){return n.y-Ht.diameter/2<=ne.cushionWidth}isBallPosOutsideLeftBorder(n){return n.x-Ht.diameter/2<=ne.cushionWidth}isBallPosOutsideRightBorder(n){return n.x+Ht.diameter/2>=Hr.x-ne.cushionWidth}isBallPosOutsideBottomBorder(n){return n.y+Ht.diameter/2>=Hr.y-ne.cushionWidth}handleCollisionWithTopCushion(n){n.position=n.position.addY(ne.cushionWidth-n.position.y+Ht.diameter/2),n.velocity=new D(n.velocity.x,-n.velocity.y)}handleCollisionWithLeftCushion(n){n.position=n.position.addX(ne.cushionWidth-n.position.x+Ht.diameter/2),n.velocity=new D(-n.velocity.x,n.velocity.y)}handleCollisionWithRightCushion(n){n.position=n.position.addX(Hr.x-ne.cushionWidth-n.position.x-Ht.diameter/2),n.velocity=new D(-n.velocity.x,n.velocity.y)}handleCollisionWithBottomCushion(n){n.position=n.position.addY(Hr.y-ne.cushionWidth-n.position.y-Ht.diameter/2),n.velocity=new D(n.velocity.x,-n.velocity.y)}resolveBallCollisionWithCushion(n){let i=!1;this.isBallPosOutsideTopBorder(n.nextPosition)&&(this.handleCollisionWithTopCushion(n),i=!0),this.isBallPosOutsideLeftBorder(n.nextPosition)&&(this.handleCollisionWithLeftCushion(n),i=!0),this.isBallPosOutsideRightBorder(n.nextPosition)&&(this.handleCollisionWithRightCushion(n),i=!0),this.isBallPosOutsideBottomBorder(n.nextPosition)&&(this.handleCollisionWithBottomCushion(n),i=!0),i&&(n.velocity=n.velocity.mult(1-Ts.collisionLoss))}resolveBallsCollision(n,i){if(!n.visible||!i.visible)return!1;const o=n.position.subtract(i.position),f=o.length;if(f>Ht.diameter)return!1;const _=o.mult((Ht.diameter-f)/f);n.position=n.position.add(_.mult(.5)),i.position=i.position.subtract(_.mult(.5));const b=o.mult(1/o.length),P=new D(-b.y,b.x),L=b.dot(n.velocity),ht=P.dot(n.velocity),tt=b.dot(i.velocity),F=P.dot(i.velocity),Zt=b.mult(tt),we=P.mult(ht),xe=b.mult(L),$e=P.mult(F);return n.velocity=Zt.add(we),i.velocity=xe.add($e),n.velocity=n.velocity.mult(1-Ts.collisionLoss),i.velocity=i.velocity.mult(1-Ts.collisionLoss),!0}handleCollisions(){for(let n=0;n<this._balls.length;n++){this.resolveBallCollisionWithCushion(this._balls[n]);for(let i=n+1;i<this._balls.length;i++){const o=this._balls[n],f=this._balls[i];if(this.resolveBallsCollision(o,f)){const b=o.velocity.length+f.velocity.length,P=al(b,0,Ht.maxExpectedCollisionForce,0,1);if(pt.playSound(Ha.paths.ballsCollide,P),!this._turnState.firstCollidedBallColor){const L=o.color===V.white?f.color:o.color;this._turnState.firstCollidedBallColor=L}}}}}isInsidePocket(n){return ne.pocketsPositions.some(i=>n.distFrom(i)<=ne.pocketRadius)}resolveBallInPocket(n){this.isInsidePocket(n.position)&&n.hide()}isValidPlayerColor(n){return n===V.red||n===V.yellow}handleBallsInPockets(){this._balls.forEach(n=>{this.resolveBallInPocket(n),!n.visible&&!this._turnState.pocketedBalls.includes(n)&&(pt.playSound(Ha.paths.rail,1),!this.currentPlayer.color&&this.isValidPlayerColor(n.color)&&(this.currentPlayer.color=n.color,this.nextPlayer.color=n.color===V.yellow?V.red:V.yellow),this._turnState.pocketedBalls.push(n))})}handleBallInHand(){ye.isPressed(Wa.mousePlaceBallButton)&&this.isValidPosToPlaceCueBall(ye.position)?this.placeBallInHand(ye.position):(this._stick.movable=!1,this._stick.visible=!1,this._cueBall.position=ye.position)}handleGameOver(){this._turnState.isValid?this.currentPlayer.overallScore++:this.nextPlayer.overallScore++,this.initMatch()}nextTurn(){const n=!this._turnState.isValid;if(this.isGameOver){this.handleGameOver();return}this._cueBall.visible||this._cueBall.show(D.copy(E.cueBallPosition)),(n||this._turnState.pocketedBalls.length===0)&&(this._currentPlayerIndex++,this._currentPlayerIndex=this._currentPlayerIndex%this._players.length),this._stick.show(this._cueBall.position),this._turnState=new Da,this._turnState.ballInHand=n,this.isAITurn()&&Hn.startSession(this)}drawCurrentPlayerLabel(){z.drawText(me.currentPlayer.text+(this._currentPlayerIndex+1),me.currentPlayer.font,me.currentPlayer.color,me.currentPlayer.position,me.currentPlayer.alignment)}drawMatchScores(){for(let n=0;n<this._players.length;n++)for(let i=0;i<this._players[n].matchScore;i++){const o=D.copy(Fa.scoresPositions[n]).addToX(i*Fa.unitMargin),f=this._players[n].color===V.red?pt.getSprite(As.paths.redScore):pt.getSprite(As.paths.yellowScore);z.drawImage(f,o)}}drawOverallScores(){for(let n=0;n<this._players.length;n++)z.drawText(this._players[n].overallScore.toString(),me.overalScores[n].font,me.overalScores[n].color,me.overalScores[n].position,me.overalScores[n].alignment)}isInsideTableBoundaries(n){let i=!this.isInsidePocket(n);return i=i&&!this.isBallPosOutsideTopBorder(n),i=i&&!this.isBallPosOutsideLeftBorder(n),i=i&&!this.isBallPosOutsideRightBorder(n),i=i&&!this.isBallPosOutsideBottomBorder(n),i}isAITurn(){return Hn.finishedSession&&Ua.on&&this._currentPlayerIndex===Ua.playerIndex}initMatch(){this._cueBall=new Gn(D.copy(E.cueBallPosition),V.white),this._stick=new Wm(D.copy(E.cueBallPosition)),this._balls=[],this._currentPlayerIndex=0,this._players.forEach(n=>{n.matchScore=0,n.color=null}),this._turnState=new Da,this._referee=new km,this.isAITurn()&&Hn.startSession(this)}isValidPosToPlaceCueBall(n){return this._balls.every(o=>o.color===V.white||o.position.distFrom(n)>Ht.diameter)&&this.isInsideTableBoundaries(n)}placeBallInHand(n){this._cueBall.position=n,this._turnState.ballInHand=!1,this._stick.show(this._cueBall.position)}concludeTurn(){this._turnState.pocketedBalls.forEach(n=>{const i=this._balls.indexOf(n);n.color!=V.white&&this._balls.splice(i,1)}),this.currentPlayer.color&&(this.currentPlayer.matchScore=8-this.getBallsByColor(this.currentPlayer.color).length-this.getBallsByColor(V.black).length),this.nextPlayer.color&&(this.nextPlayer.matchScore=8-this.getBallsByColor(this.nextPlayer.color).length-this.getBallsByColor(V.black).length),this._turnState.isValid=this._referee.isValidTurn(this.currentPlayer,this._turnState)}shootCueBall(n,i){n>0&&(this._stick.rotation=i,this._stick.shoot(),this._cueBall.shoot(n,i),this._stick.movable=!1,setTimeout(()=>this._stick.hide(),E.timeoutToHideStickAfterShot))}update(){if(this.isBallInHand){this.handleBallInHand();return}this.handleBallsInPockets(),this.handleCollisions(),this.handleInput(),this._balls.forEach(n=>n.update()),!this.isBallsMoving&&!this._stick.visible&&(this.concludeTurn(),this.nextTurn())}draw(){z.drawImage(pt.getSprite(As.paths.table)),this.drawCurrentPlayerLabel(),this.drawMatchScores(),this.drawOverallScores(),this._balls.forEach(n=>n.draw()),this._stick.draw()}}class Fm{constructor(n){A(this,"mainGame");this.mainGame=n}handleRotatedStick(n,i,o){const f=n[0];this.updateStick(f.rotation)}updateStick(n){this.mainGame._poolGame._stick.update(n)}handleCueMoved(n,i){const o=new D(n.x,n.y);this.mainGame._poolGame._cueBall.position=o,this.mainGame._poolGame._stick.show(o)}drawAll(){}}const Um=E.sprites,Hm=E.input;class Gm{constructor(){A(this,"_menuActionsMap");A(this,"_previousMenus",[]);A(this,"_menu",new Gs);A(this,"_poolGame");A(this,"_isLoading");A(this,"_inGame")}initMenuActions(){this._menuActionsMap=new Map,this._menuActionsMap.set(wt.PVP,new Cm(this)),this._menuActionsMap.set(wt.PVC,new Am(this)),this._menuActionsMap.set(wt.ToggleSound,new Tm),this._menuActionsMap.set(wt.GoToSubMenu,new Bm(this)),this._menuActionsMap.set(wt.GoToPreviousMenu,new Sm(this))}initMainMenu(){this._menu.init(this._menuActionsMap,E.mainMenu)}displayLoadingScreen(){return new Promise(n=>{this._isLoading=!0,z.clear(),z.drawImage(pt.getSprite(Um.paths.controls),E.loadingScreenImagePosition),setTimeout(()=>{this._isLoading=!1,n()},E.loadingScreenTimeout)})}handleInput(){this._inGame&&zr.isPressed(Hm.toggleMenuKey)&&(this._menu.active?this._menu.active=!1:(this.initMainMenu(),this._menu.active=!0))}update(){this._isLoading||(this.handleInput(),this._menu.active?this._menu.update():this._poolGame.update(),zr.reset(),ye.reset())}draw(){this._isLoading||Hn.finishedSession&&(z.clear(),this._menu.active?this._menu.draw():this._poolGame.draw())}gameLoop(){this.draw(),window.requestAnimationFrame(()=>{this.gameLoop()})}async init(){await pt.loadGameAssets(),this.initMenuActions(),this.initMainMenu(),this._menu.active=!0,this._poolGame=new Ga,this.gameLoop(),this.start()}goToSubMenu(n){setTimeout(()=>{this._menu&&(this._menu.active=!1,this._previousMenus.push(this._menu)),this._menu=this._menu.getSubMenu(n),this._menu.active=!0},E.timeoutToLoadSubMenu)}goToPreviousMenu(){this._previousMenus.length>0&&setTimeout(()=>{this._menu.active=!1,this._menu=this._previousMenus.pop(),this._menu.active=!0},E.timeoutToLoadSubMenu)}start(){this.displayLoadingScreen().then(async()=>{this._menu.active=!1,this._inGame=!0,this._poolGame=new Ga,this._poolGame.initMatch();const n=new Fm(this);console.log("emitting join game");const{username:i,avatar:o}=await mm(y.serverData.playerId);y.socket.emit("join_game",{lobbyCode:y.lobbyCode,playerId:y.serverData.playerId,username:i,avatar:o,data:y.serverData}),y.socket.on("get_player_number",async _=>{y.myPlayerNumber=_,_==1?(y.p1u.innerText=i,y.p1a.src=o):(y.p2u.innerText=i,y.p2a.src=o),xt()?y.domTurn.innerText="YOUR TURN":y.domTurn.innerText="OPP TURN"}),y.socket.on("players",async(_,b)=>{y.myPlayerNumber==1?(y.p2u.innerText=b.username,y.p2a.src=b.avatar):(y.p1u.innerText=_.username,y.p1a.src=_.avatar)}),y.socket.on("start_game",()=>{y.started=!0,console.log("starting game"),y.waiting.style.display="none"}),y.socket.once("first_state",(_,b,P,L)=>{console.log("first state"),f(_)}),y.socket.on("rotated_stick",(_,b,P)=>{n.handleRotatedStick(_,b,P)}),y.socket.on("cue_moved",(_,b)=>{f(b),n.handleCueMoved(_,b)}),y.socket.on("update",_=>{f(_)}),y.socket.on("update_stick",_=>{y.cue.x=_.x,y.cue.y=_.y;const b=new D(_.x,_.y);n.mainGame._poolGame._stick.show(b)}),y.socket.on("switch_turn",(_,b,P)=>{y.currentTurn=_,xt()?(y.domTurn.innerText="YOUR TURN",y.socket.emit("rotate_stick",y.lobbyCode,y.stickAngle)):y.domTurn.innerText="OPP TURN",b&&(y.opponentInvalidCue=!0);const L=P.filter(tt=>tt.label=="cue")[0];console.log(L),y.cue.x=L.x,y.cue.y=L.y;const ht=new D(L.x,L.y);n.mainGame._poolGame._stick.show(ht),f(P)}),y.socket.on("colors",(_,b)=>{y.p1aDiv.style.border=`4px solid ${_.color}`,y.p2aDiv.style.border=`4px solid ${b.color}`}),y.socket.on("winner",_=>{_.player==y.myPlayerNumber?alert("you won"):alert("you lost")}),y.socket.on("timer",_=>{y.domTime.innerText=String(_)});function f(_){n.mainGame._poolGame.balls.splice(0);const b=_.filter(F=>F.label.split(" ")[1]=="red"),P=_.filter(F=>F.label.split(" ")[1]=="yellow"),L=_.filter(F=>F.label.split(" ")[1]=="eight"),ht=_.filter(F=>F.label=="cue"),tt=[...b.map(F=>new Gn(new D(F.x,F.y),V.red)),...P.map(F=>new Gn(new D(F.x,F.y),V.yellow)),...L.map(F=>new Gn(new D(F.x,F.y),V.black)),...ht.map(F=>new Gn(new D(F.x,F.y),V.white))];n.mainGame._poolGame.balls.push(...tt)}})}}const qm=new Gm;qm.init();
